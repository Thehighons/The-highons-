<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="The Highon's - Premium creative supplies including keychains, art supplies, stationery, gadgets, and diaries available for inquiry and order in Navsari, Gujarat.">
    <title>The Highon's - Premium Creative Supplies | Navsari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Define a local font or use a suitable web font fallback */
        /* @font-face {
          font-family: 'Trajan Pro';
          src: url('trajan-pro.woff2') format('woff2'), url('trajan-pro.woff') format('woff');
          font-display: swap;
        } */
        /* Fallback font for brand name */
        .brand-font {
            font-family: 'Playfair Display', serif; /* Using Playfair Display for a sophisticated look */
        }

        :root {
          --bg-dark: #16161a; /* Deepest background */
          --text-main: #fffffe; /* Main text color */
          --text-secondary: #94a1b2; /* Secondary text/placeholder color */
          --primary-accent: #7f5af0; /* Main interactive/highlight color (Violet) */
          --secondary-accent: #2cb67d; /* Secondary interactive/highlight color (Emerald) */
          --card-bg: #242629; /* Background for cards/containers */
          --border-color: rgba(148, 161, 178, 0.2); /* Subtle border */
          --danger-color: #f05a7f; /* Red for negative/increase */
          --success-color: var(--secondary-accent); /* Green for positive/discount */
        }

        /* Smooth Scrolling */
        html {
          scroll-behavior: smooth;
        }

        body {
          font-family: 'Montserrat', sans-serif;
          background-color: var(--bg-dark);
          color: var(--text-main);
          overflow-x: hidden; /* Prevent horizontal scroll */
        }
        /* Prevent body scroll when modal is open */
        body.overflow-hidden {
            overflow: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
          font-family: 'Playfair Display', serif;
          color: var(--text-main);
          font-weight: 600;
        }
        .brand-name {
          font-family: 'Playfair Display', serif; /* Using Playfair Display */
          letter-spacing: 1.5px;
          color: var(--text-main);
          font-weight: 700; /* Make it slightly bolder */
        }

        /* Header Styling */
        header {
          background-color: rgba(22, 22, 26, 0.8); /* Slightly transparent dark bg */
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border-bottom: 1px solid var(--border-color);
        }

        /* Navigation Links */
        .nav-link {
          position: relative;
          color: var(--text-secondary);
          transition: all 0.3s ease;
          padding: 0.5rem 0; /* Adjust padding for underline */
          font-weight: 500;
          margin: 0 0.5rem; /* Add spacing between links */
        }
        .nav-link:hover, .nav-link.active {
          color: var(--text-main);
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px; /* Position below text */
            left: 50%;
            background-color: var(--primary-accent); /* Use accent color */
            transition: all 0.3s ease;
            transform: translateX(-50%);
            border-radius: 1px;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%; /* Full underline effect */
        }

        /* Hero Section */
        .hero-section {
            position: relative;
            overflow: hidden;
            background: radial-gradient(ellipse at bottom, var(--bg-dark) 0%, #1a1a2e 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
         .hero-section .max-w-4xl {
             position: relative;
             z-index: 10; /* Ensure content is above shapes */
         }
        /* Animated background shapes */
        .hero-shapes {
            position: absolute;
            inset: 0;
            z-index: 0;
            overflow: hidden;
        }
        .hero-shapes div {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-accent), var(--secondary-accent));
            opacity: 0.1;
            filter: blur(30px); /* Blur the shapes */
            animation: drift 20s infinite linear alternate;
        }
        .hero-shapes div:nth-child(1) { width: 200px; height: 200px; top: 5%; left: 10%; animation-duration: 25s; }
        .hero-shapes div:nth-child(2) { width: 100px; height: 100px; top: 60%; left: 75%; animation-duration: 20s; animation-delay: 2s; }
        .hero-shapes div:nth-child(3) { width: 150px; height: 150px; top: 30%; left: 45%; animation-duration: 28s; animation-delay: 4s; }
        .hero-shapes div:nth-child(4) { width: 180px; height: 180px; top: 80%; left: 20%; animation-duration: 23s; animation-delay: 1s; }


        @keyframes drift {
            from { transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); }
            to { transform: translateY(30px) translateX(-20px) rotate(30deg) scale(1.1); }
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            border: none;
            position: relative;
            overflow: hidden;
            z-index: 1;
            white-space: nowrap;
             box-shadow: 0 4px 15px rgba(0,0,0,0.2); /* Subtle shadow for depth */
        }
        .btn::before { /* Subtle shine effect on hover */
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Smoother shine */
            z-index: -1;
        }
        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-accent) 0%, #a787ff 100%);
            color: var(--text-main);
            box-shadow: 0 6px 20px rgba(127, 90, 240, 0.3); /* More prominent shadow */
        }
        .btn-primary:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 8px 25px rgba(127, 90, 240, 0.4);
        }
         .btn-primary:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
             box-shadow: 0 4px 15px rgba(0,0,0,0.2); /* Reset shadow when disabled */
             pointer-events: none; /* Prevent shine on hover when disabled */
         }
          .btn-primary:disabled::before {
               left: -100%; /* Disable shine effect */
          }


        .btn-secondary {
            background-color: transparent;
            color: var(--primary-accent);
            border: 2px solid var(--primary-accent);
            box-shadow: none; /* No shadow for secondary */
        }
        .btn-secondary:hover {
            background-color: rgba(127, 90, 240, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 2px 10px rgba(127, 90, 240, 0.1); /* Subtle shadow on hover */
        }

         /* Small buttons for quantity control */
         .btn-small {
             padding: 0.3rem 0.8rem;
             font-size: 0.9rem;
             border-radius: 9999px;
         }


        /* Product Section */
         #products {
            background: linear-gradient(to bottom, var(--bg-dark), #1a1a2e);
            position: relative;
            padding-top: 6rem; /* Adjusted padding */
            padding-bottom: 6rem; /* Adjusted padding */
         }
         #products::before { /* Top separator glow */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 150px; /* Increased size */
            background: linear-gradient(to bottom, rgba(22, 22, 26, 0), rgba(127, 90, 240, 0.08)); /* Subtle gradient */
            pointer-events: none;
            z-index: 1;
         }

        .category-title {
            background: linear-gradient(135deg, var(--primary-accent) 0%, var(--secondary-accent) 100%);
            color: var(--text-main);
            padding: 10px 28px; /* Adjusted padding */
            border-radius: 8px;
            display: inline-block;
            margin: 20px 0 40px 0; /* Adjusted margin */
            box-shadow: 0 4px 12px rgba(44, 182, 125, 0.2);
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1.1rem; /* Slightly smaller */
            text-transform: uppercase; /* Uppercase category titles */
             letter-spacing: 0.5px;
        }

        /* Redesigned Product Card */
        .product-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px; /* Slightly less rounded than containers */
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            transform-style: preserve-3d;
            box-shadow: 0 8px 20px rgba(0,0,0, 0.2); /* More prominent shadow */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer; /* Indicate clickability for details */
        }
        .product-card:hover {
            transform: translateY(-8px) rotateX(2deg) rotateY(-1deg); /* Less extreme tilt */
            box-shadow: 0 18px 35px rgba(0,0,0, 0.35); /* Enhanced shadow on hover */
            border-color: rgba(127, 90, 240, 0.6); /* Stronger accent border */
        }
         .product-card::after { /* Subtle glow effect */
             content: '';
             position: absolute;
             inset: -1px;
             background: radial-gradient(ellipse at center, rgba(127, 90, 240, 0.25) 0%, transparent 70%); /* Stronger glow */
             opacity: 0;
             transition: opacity 0.5s ease; /* Slower glow transition */
             z-index: 0; /* Behind content, above background */
             border-radius: 12px;
         }
         .product-card:hover::after {
             opacity: 1;
         }

        .product-image-wrapper {
            height: 180px; /* Slightly reduced height */
            background-color: rgba(255, 255, 255, 0.03); /* Subtler bg for image */
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem; /* Reduced padding */
            overflow: hidden;
            position: relative;
            z-index: 1; /* Ensure image is above glow */
        }
        .product-image-wrapper img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: transform 0.4s ease;
        }
        .product-card:hover .product-image-wrapper img {
            transform: scale(1.05); /* Subtler zoom */
        }

        .product-card-content {
            padding: 1rem 1.25rem; /* Adjusted padding */
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
             position: relative;
             z-index: 1; /* Ensure text is above glow */
        }
        .product-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem; /* Slightly smaller title */
            font-weight: 600;
            margin-bottom: 0.4rem; /* Adjusted margin */
            color: var(--text-main);
            min-height: 2.6em; /* Adjusted height */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
         .product-card p.product-desc {
             font-size: 0.8rem; /* Smaller description text */
             color: var(--text-secondary);
             margin-bottom: 0.8rem; /* Adjusted margin */
             min-height: 3.2em; /* Adjusted height */
             display: -webkit-box;
             -webkit-line-clamp: 3;
             -webkit-box-orient: vertical;
             overflow: hidden;
             text-overflow: ellipsis;
         }
        .product-card .product-price {
            font-size: 1.3rem; /* Slightly smaller price */
            font-weight: 700;
            color: var(--primary-accent);
            margin-bottom: 1rem; /* Adjusted margin */
        }
        /* Product Controls - Centered at the bottom */
        .product-card-controls {
            padding: 0 1.25rem 1.25rem;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
             position: relative;
             z-index: 1; /* Ensure buttons are above glow */
        }

        .product-quantity-controls {
             display: flex;
             align-items: center;
             gap: 0.6rem; /* Increased space */
             width: 100%;
             justify-content: center;
        }
         .product-quantity {
             font-size: 1rem; /* Slightly smaller quantity font */
             font-weight: 700;
             color: var(--text-main);
             min-width: 35px; /* Ensure enough width */
             text-align: center;
         }

        /* Filter/Search Styling */
        #productSearch, #categoryFilter, #couponCode {
            background-color: var(--card-bg);
            color: var(--text-main);
            border: 1px solid var(--border-color);
            border-radius: 50px;
            padding: 0.7rem 1.5rem; /* Adjusted padding */
            transition: all 0.3s ease;
            font-size: 0.95rem; /* Slightly smaller font */
        }
         #productSearch::placeholder, #couponCode::placeholder {
             color: var(--text-secondary);
             opacity: 0.8;
         }
        #productSearch { padding-left: 2.8rem; } /* Space for icon */
        .search-input-wrapper { position: relative; }
         .search-input-wrapper .search-icon {
             position: absolute;
             left: 1rem;
             top: 50%;
             transform: translateY(-50%);
             color: var(--text-secondary);
             font-size: 1.1rem;
             pointer-events: none; /* Don't block clicks */
         }
        #categoryFilter {
          appearance: none;
          background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%2394a1b2"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>');
          background-repeat: no-repeat;
          background-position: right 1rem center;
          background-size: 1em 1em;
          padding-right: 3rem;
        }
         #categoryFilter option {
             background-color: var(--card-bg);
             color: var(--text-main);
         }

        #productSearch:focus, #categoryFilter:focus, #couponCode:focus {
             border-color: var(--primary-accent);
             box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.3);
             outline: none;
             background-color: rgba(36, 38, 41, 0.8); /* Slightly darker on focus */
        }
         #couponCode:disabled {
             opacity: 0.6;
             cursor: not-allowed;
         }


        /* Form Styling */
        .form-section {
            background-color: var(--bg-dark);
            position: relative;
            overflow: hidden;
            padding-top: 6rem;
            padding-bottom: 6rem;
        }
        .form-section::before { /* Aurora effect background */
             content: "";
             position: absolute;
             inset: 0;
             background: radial-gradient(circle at 20% 70%, rgba(127, 90, 240, 0.12) 0%, transparent 30%),
                         radial-gradient(circle at 80% 30%, rgba(44, 182, 125, 0.08) 0%, transparent 30%);
             filter: blur(40px);
             z-index: 0;
        }

        .form-container {
            background-color: rgba(36, 38, 41, 0.8);
            backdrop-filter: blur(5px);
             -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2.5rem; /* Increased padding */
            position: relative;
            z-index: 1;
            box-shadow: 0 12px 30px rgba(0,0,0,0.4); /* Increased shadow */
        }
        .form-container label {
             color: var(--text-secondary);
             font-weight: 500;
             font-size: 0.95rem; /* Slightly larger label */
             margin-bottom: 0.6rem; /* Increased margin */
             display: block;
        }
        .form-container input[type="text"],
        .form-container input[type="email"],
        .form-container input[type="tel"],
        .form-container textarea,
        .form-container select {
            background-color: rgba(22, 22, 26, 0.7);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            border-radius: 8px;
            padding: 0.9rem 1rem;
             width: 100%;
             transition: all 0.3s ease;
             font-size: 1rem;
        }
        .form-container input::placeholder,
        .form-container textarea::placeholder {
            color: rgba(148, 161, 178, 0.6);
        }
        .form-container input:focus,
        .form-container textarea:focus,
        .form-container select:focus {
            border-color: var(--primary-accent);
            background-color: rgba(22, 22, 26, 0.9);
             box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.3);
             outline: none;
        }
         .form-container select option {
             background-color: var(--bg-dark);
             color: var(--text-main);
         }

        /* Order Summary Display */
         #orderSummaryDisplay {
             background-color: rgba(22, 22, 26, 0.7);
             border: 1px solid var(--border-color);
             border-radius: 8px;
             padding: 1.25rem; /* Increased padding */
             margin-bottom: 1.5rem;
             min-height: 100px; /* Increased minimum height */
             color: var(--text-main);
             font-size: 0.95rem;
             box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); /* Inner shadow */
         }
         #orderSummaryDisplay p {
             color: var(--text-secondary);
             text-align: center;
             padding: 1rem;
         }
         #orderSummaryDisplay ul {
             list-style: none;
             padding: 0;
             margin: 0;
         }
         #orderSummaryDisplay li {
             padding: 0.6rem 0; /* Adjusted padding */
             border-bottom: 1px dashed rgba(148, 161, 178, 0.15); /* Slightly stronger dashed line */
              display: flex;
              justify-content: space-between;
              align-items: center;
         }
         #orderSummaryDisplay li:last-child {
             border-bottom: none;
         }
         #orderSummaryDisplay .order-item-name {
             font-weight: 600;
             color: var(--text-main);
             flex-grow: 1;
             margin-right: 0.75rem; /* Increased margin */
              word-break: break-word; /* Prevent long names overflowing */
         }
         #orderSummaryDisplay .order-item-quantity {
              color: var(--text-secondary);
              font-size: 0.8rem; /* Smaller quantity text */
               min-width: 30px; /* Ensure spacing */
              text-align: right;
         }
         #orderSummaryDisplay .order-item-price {
              font-weight: 500;
              color: var(--text-main);
              min-width: 60px; /* Ensure spacing */
              text-align: right;
         }
          #orderSummaryDisplay .order-summary-line {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 0.6rem 0; /* Adjusted padding */
               border-bottom: 1px dashed rgba(148, 161, 178, 0.15);
               font-weight: 500;
          }
           #orderSummaryDisplay .order-summary-line span:last-child {
               text-align: right; /* Ensure value aligns right */
           }
          #orderSummaryDisplay .order-summary-line:last-child {
              border-bottom: none;
          }

         #orderSummaryDisplay .order-total {
              font-size: 1.3rem; /* Slightly larger total font */
              font-weight: 700;
              color: var(--secondary-accent);
              margin-top: 1rem;
              text-align: right;
              padding-top: 0.75rem; /* Increased padding */
              border-top: 1px solid var(--border-color);
         }
         #orderSummaryDisplay .discount-line {
             color: var(--success-color);
             font-weight: 600;
         }
          #orderSummaryDisplay .increase-line {
              color: var(--danger-color);
               font-weight: 600;
          }

        /* Contact Section */
        #contact {
            background-color: var(--card-bg);
            padding-top: 6rem;
            padding-bottom: 6rem;
        }
        .contact-info-box {
             background-color: rgba(22, 22, 26, 0.8);
             border: 1px solid var(--border-color);
             border-radius: 12px;
             padding: 2.5rem; /* Increased padding */
             transition: all 0.3s ease;
             box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        .contact-info-box:hover {
             border-color: var(--primary-accent);
             transform: translateY(-5px);
             box-shadow: 0 12px 25px rgba(0,0,0,0.3);
        }
        .contact-info-box a {
            color: var(--primary-accent);
            transition: color 0.3s ease;
            word-break: break-word; /* Allow long email to break line */
        }
        .contact-info-box a:hover {
            color: var(--secondary-accent);
            text-decoration: underline;
        }
         .contact-info-box p span {
             color: var(--text-secondary); /* Slightly lighter font for labels */
         }
        .social-icons a {
            color: var(--text-secondary);
            font-size: 2rem; /* Larger icons */
            transition: all 0.3s ease;
             padding: 0 10px; /* Add click area */
        }
        .social-icons a:hover {
             color: var(--primary-accent);
             transform: scale(1.1) rotate(0deg); /* Simpler hover effect */
        }

        /* Footer */
        footer {
            background-color: var(--bg-dark);
            border-top: 1px solid var(--border-color);
            padding-top: 3rem; /* Adjusted padding */
            padding-bottom: 3rem; /* Adjusted padding */
        }
        footer .brand-name { color: var(--text-main); }
        footer a { color: var(--text-secondary); transition: color 0.3s ease; }
        footer a:hover { color: var(--primary-accent); }
        footer .text-gray-500 { color: var(--text-secondary); opacity: 0.8; font-size: 0.75rem; }

        /* Modal Styling */
        .modal-backdrop {
             background-color: rgba(22, 22, 26, 0.85); /* Darker backdrop */
             backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
             transition: opacity 0.3s ease;
        }
        .modal-content {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            color: var(--text-main);
             box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5); /* Stronger shadow */
             animation-duration: 0.4s; /* Faster zoom */
        }
        .modal-content img { border-radius: 8px; background-color: rgba(255,255,255,0.05); padding: 1rem;} /* Padding for image */
        .modal-content h3 { color: var(--text-main); margin-bottom: 0.5rem; }
        .modal-content p { color: var(--text-secondary); font-size: 0.9rem; }
        .modal-content .modal-price { color: var(--primary-accent); font-size: 2rem; font-weight: 700; margin-top: 1rem; }
        .modal-close-btn {
            color: var(--text-secondary);
            transition: all 0.3s ease;
             top: 1.5rem; right: 1.5rem; /* Adjusted position */
            font-size: 2rem; /* Adjusted size */
            padding: 5px; /* Add click area */
            background: rgba(36, 38, 41, 0.5); /* Background for visibility */
            border-radius: 50%;
        }
        .modal-close-btn:hover {
             color: var(--text-main);
             transform: rotate(90deg);
             background: rgba(36, 38, 41, 0.8);
        }

        /* Loader */
        .loader {
          border: 4px solid rgba(148, 161, 178, 0.2); /* Lighter grey border */
          border-top: 4px solid var(--primary-accent); /* Accent color spinner */
          border-radius: 50%;
          width: 50px;
          height: 50px;
          animation: spin 1s linear infinite;
          margin: 80px auto;
        }
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        /* Animation Utilities */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

         /* Small utility to make element not selectable */
         .unselectable {
            user-select: none;
             -webkit-user-select: none;
             -ms-user-select: none;
         }


    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex items-center justify-between p-4 lg:px-8"> <div class="flex items-center">
                <a href="#" class="text-2xl tracking-wide brand-name">THE HIGHON'S</a>
            </div>
            <nav class="hidden md:flex items-center space-x-4 lg:space-x-6"> <a href="#products" class="nav-link">Products</a>
                <a href="#order" class="nav-link">Place Order</a>
                <a href="#request" class="nav-link">Request Product</a>
                <a href="#contact" class="nav-link">Contact</a>
            </nav>
            <div class="md:hidden flex items-center">
                <button onclick="toggleMobileMenu()" class="text-gray-300 hover:text-white focus:outline-none p-2 rounded-md" aria-label="Toggle mobile menu"> <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        <div id="mobileMenu" class="hidden md:hidden bg-gradient-to-b from-[rgba(36,38,41,0.95)] to-[rgba(22,22,26,0.95)] backdrop-blur-sm border-t border-[rgba(148,161,178,0.2)] p-4 absolute w-full shadow-lg z-40"> <div class="flex flex-col items-center space-y-4">
                <a href="#products" class="nav-link block py-2" onclick="toggleMobileMenu()">Products</a>
                <a href="#order" class="nav-link block py-2" onclick="toggleMobileMenu()">Place Order</a>
                <a href="#request" class="nav-link block py-2" onclick="toggleMobileMenu()">Request Product</a>
                <a href="#contact" class="nav-link block py-2" onclick="toggleMobileMenu()">Contact</a>
            </div>
        </div>
    </header>

    <section class="hero-section text-center pt-28 pb-20 md:pt-36 md:pb-28 relative">
        <div class="hero-shapes">
            <div></div> <div></div> <div></div> <div></div> </div>

        <div class="max-w-4xl mx-auto px-6 relative z-10">
             <img src="GridArt_20250428_230202733.png" alt="The Highon's Brand Logo - Abstract, Creative" class="w-56 sm:w-72 md:w-80 mx-auto mb-8 animate__animated animate__fadeInDown" loading="lazy">

            <h1 class="text-4xl md:text-6xl font-bold mb-6 animate__animated animate__fadeInUp">
                Ignite Your <span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-emerald-400">Creativity</span>.
            </h1>
            <p class="text-lg md:text-xl mb-10 text-gray-300 max-w-2xl mx-auto animate__animated animate__fadeInUp animate__delay-0-5s"> Discover premium art supplies, stationery, keychains, and unique gadgets in Navsari.
            </p>
            <a href="#products" class="btn btn-primary text-lg px-10 py-4 animate__animated animate__fadeInUp animate__delay-1s"> Explore Collection
            </a>
        </div>
         <div class="mt-20 flex justify-center space-x-4 sm:space-x-6 opacity-80 relative z-10"> <img src="Screenshot_20250422_132243_Meesho.jpg" alt="Keychain product" class="w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover shadow-lg border-2 border-purple-500/50 animate__animated animate__fadeIn animate__delay-1-5s" loading="lazy"> <img src="Screenshot_20250424_134214_Meesho.jpg" alt="Art supplies" class="w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover shadow-lg border-2 border-emerald-500/50 animate__animated animate__fadeIn animate__delay-1-8s" loading="lazy"> <img src="81EROqfMQBL._AC_UF1000,1000_QL80_.jpg" alt="Diary product" class="w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover shadow-lg border-2 border-purple-500/50 animate__animated animate__fadeIn animate__delay-2-1s" loading="lazy"> </div>
    </section>

    <section id="products" class="py-20 px-6 relative z-10"> <div class="max-w-7xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold mb-12 text-center reveal">Our Collection</h2>
            <div class="flex flex-col md:flex-row justify-between items-center mb-16 gap-6 reveal">
                <div class="relative w-full md:w-2/5 lg:w-1/3 search-input-wrapper"> <input type="text" id="productSearch" placeholder="Search products..." class="w-full" aria-label="Search products">
                    <i class="fas fa-search search-icon"></i> </div>
                <div class="filter-selector text-center md:text-right w-full md:w-auto">
                    <label for="categoryFilter" class="mr-2 font-semibold text-gray-400">Filter:</label>
                    <select id="categoryFilter" class="" aria-label="Select product category">
                        <option value="all">All Products</option>
                        <option value="keychains">Keychains</option>
                        <option value="artSupplies">Art Supplies</option>
                        <option value="stationery">Stationery</option>
                        <option value="diaries">Diaries</option>
                        <option value="gadgets">Gadgets</option>
                    </select>
                </div>
            </div>
            <div id="productsContainer" class="relative min-h-[300px]">
                 <div class="loader"></div> </div>
        </div>
    </section>

     <section id="order" class="py-20 px-6 form-section">
        <div class="max-w-3xl mx-auto text-center reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Place Your Order</h2>
            <div id="orderFormContainer" class="text-left">
                <p class="text-gray-400 mb-6 text-center">Items added from the 'Our Collection' section will appear below. Fill in your details to place your order for delivery within Navsari (PIN: 396445).</p>

                <div>
                     <label class="mb-2 block text-secondary">Your Order Summary</label>
                     <div id="orderSummaryDisplay">
                         <p>Add items from the collection above to see your order here.</p>
                     </div>
                </div>

                 <div class="mt-6 mb-4">
                     <label for="couponCode" class="mb-2 block text-secondary">Have a Coupon Code?</label>
                     <input type="text" id="couponCode" placeholder="Enter coupon code (optional)" aria-label="Enter coupon code">
                      <p id="couponFeedback" class="text-sm mt-2 min-h-[1.2em]"></p> </div>


                <form id="orderForm" action="https://formsubmit.co/thehighonsofficial@gmail.com" method="POST" class="space-y-6 text-left">
                     <input type="hidden" name="_next" value="YOUR_THANK_YOU_URL_FOR_ORDER">
                     <input type="hidden" name="_captcha" value="false">
                     <input type="hidden" name="_subject" id="formSubject" value="New Order from The Highon's Site!">
                     <input type="hidden" name="Order Details" id="hiddenOrderSummary" value=""> <div>
                        <label for="orderName">Full Name</label>
                        <input type="text" id="orderName" name="name" placeholder="Enter your full name" required aria-label="Full Name for order">
                    </div>
                    <div>
                        <label for="orderEmail">Email</label>
                        <input type="email" id="orderEmail" name="email" placeholder="Enter your email" required aria-label="Email Address for order">
                    </div>
                     <div>
                        <label for="orderPhone">Phone (+91)</label>
                         <input type="tel" id="orderPhone" name="phone" placeholder="Enter 10-digit number" required pattern="[6-9]\d{9}" title="Please enter a valid 10-digit Indian mobile number (starting with 6, 7, 8, or 9)" aria-label="Phone number for order (starts with 6-9, 10 digits)">
                    </div>
                    <div>
                        <label for="orderAddress">Full Address (Navsari)</label>
                        <input type="text" id="orderAddress" name="address" placeholder="House No, Street, Area, Navsari - 396445" required aria-label="Full Address for order">
                    </div>

                    <button type="button" id="forgetMyDetailsBtn" class="text-sm text-gray-500 hover:text-red-400 focus:outline-none transition-colors duration-200 mt-2 hidden" aria-label="Forget my saved details">
                        Forget My Details
                    </button>

                     <div>
                        <label for="orderNotes">Additional Notes (Optional)</label>
                         <textarea id="orderNotes" name="Additional Notes" rows="3" placeholder="Any specific instructions or details?" aria-label="Additional notes for order"></textarea>
                    </div>

                    <div>
                        <label for="orderPayment">Payment Option</label>
                        <select id="orderPayment" name="payment" class="w-full" aria-label="Payment option">
                            <option value="COD">Cash on Delivery</option>
                            <option value="UPI">UPI Payment</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary w-full" id="placeOrderBtn">Place Order</button>
                </form>
            </div>
        </div>
    </section>


    <section id="request" class="py-20 px-6 form-section">
        <div class="max-w-2xl mx-auto text-center reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Request a Product</h2>
            <p class="text-gray-400 mb-8 max-w-xl mx-auto">Can't find what you're looking for? Let us know, and we'll try our best to source it for you!</p>
            <div class="form-container">
                <form id="requestForm" action="https://formsubmit.co/thehighonsofficial@gmail.com" method="POST" class="space-y-6 text-left">
                    <input type="hidden" name="_next" value="YOUR_THANK_YOU_URL_FOR_REQUEST">
                    <input type="hidden" name="_subject" value="New Product Request from The Highon's Site">
                    <input type="hidden" name="_captcha" value="false">
                    <div>
                        <label for="requestName">Product Name</label>
                        <input type="text" id="requestName" name="product" placeholder="e.g., Specific brand watercolor set" required aria-label="Product name for request">
                    </div>
                    <div>
                        <label for="requestDetails">Additional Details (Optional)</label>
                        <textarea id="requestDetails" name="details" rows="4" placeholder="Brand, color, size, quantity, etc." aria-label="Additional details for product request"></textarea>
                    </div>
                    <div>
                        <label for="requestEmail">Your Email</label>
                        <input type="email" id="requestEmail" name="email" placeholder="your.email@example.com" required aria-label="Your email address for request">
                    </div>
                    <button type="submit" class="btn btn-primary w-full mt-4">Submit Request</button>
                </form>
            </div>
        </div>
    </section>

    <section id="contact" class="py-20 text-center px-6">
        <div class="max-w-4xl mx-auto reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Get In Touch</h2>
            <div class="grid grid-cols-1 gap-8 text-left">
                <div class="contact-info-box">
                    <h3 class="text-2xl font-semibold mb-6 text-center">Contact Information</h3>
                    <div class="space-y-4 text-center text-lg">
                        <p><span class="font-medium">Email:</span> <a href="mailto:thehighonsofficial@gmail.com">thehighonsofficial@gmail.com</a></p>
                        <p><span class="font-medium">Location:</span> Navsari, Gujarat - 396445</p>
                         <p class="text-sm text-gray-500">(Online orders via this site for local delivery only)</p>
                    </div>
                    <div class="flex justify-center space-x-6 mt-8 social-icons">
                        <a href="https://instagram.com/thehighons" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
                         </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="py-10 mt-auto">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left gap-6">
                <div>
                    <span class="text-2xl font-bold tracking-wide brand-name">THE HIGHON'S</span>
                    <p class="mt-1 text-sm text-gray-400">Premium Creative Supplies - Navsari</p>
                </div>
                <div class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-sm">
                    <a href="#products">Products</a>
                    <a href="#order">Place Order</a>
                    <a href="#request">Request</a>
                    <a href="#contact">Contact</a>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500 text-xs">
                <p> <span id="footerYear"></span> The Highon's. All rights reserved.</p> </div>
        </div>
    </footer>

    <div id="productModal" class="fixed inset-0 z-[70] modal-backdrop flex items-center justify-center hidden p-4 opacity-0 pointer-events-none transition-opacity duration-300"> <div class="modal-content relative max-w-lg w-full mx-auto animate__animated animate__zoomIn animate__faster overflow-hidden transform scale-95 transition-transform duration-300"> <button type="button" onclick="closeModal()" class="modal-close-btn absolute z-10" aria-label="Close product details modal">&times;</button> <div class="p-6 sm:p-8 max-h-[80vh] overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <img id="modalImg" src="" alt="" class="w-full h-64 md:h-auto object-contain" loading="lazy"> <div class="flex flex-col justify-center">
                        <h3 id="modalName" class="text-2xl lg:text-3xl font-bold mb-3"></h3>
                        <p id="modalDesc" class="text-sm lg:text-base mb-5"></p>
                        <p id="modalPrice" class="modal-price mb-6"></p>
                        <p class="text-sm text-gray-400">To order this item, please go to the <a href="#products" onclick="closeModal()" class="text-purple-400 hover:text-emerald-400 underline">Our Collection section</a> and click 'Add' on the product card.</p>
                    </div>
                </div>
             </div>
        </div>
    </div>

    <script>
        // --- Constants ---
        const USER_DETAILS_STORAGE_KEY = 'highonsUserDetails'; // Key for localStorage
        const CART_STORAGE_KEY = 'highonsCartItems'; // Key for localStorage

        // --- Product Data ---
        const products = {
             keychains: [
                { id: "kc001", name: "Thor Loki Keychain", price: 99, img: "Screenshot_20250422_132243_Meesho.jpg", desc: "High-quality metal keychain featuring Thor and Loki designs" },
                { id: "kc002", name: "Thor Hammer Keychain", price: 89, img: "Screenshot_20250422_131740_Meesho.jpg", desc: "Durable Mjolnir keychain with detailed engraving" },
                { id: "kc003", name: "Demon slayer katana keychain", price: 159, img: "Screenshot_20250424_141150_Meesho.jpg", desc: "Miniature katana keychain from Demon Slayer anime" },
                { id: "kc004", name: "Pikachu Keychain", price: 109, img: "Screenshot_20250422_131948_Meesho.jpg", desc: "Cute Pikachu keychain with enamel finish" }
            ],
            artSupplies: [
                { id: "as001", name: "Camel water colour tube", price: 169, img: "Screenshot_20250424_134214_Meesho.jpg", desc: "Professional-grade watercolor tubes, set of 12 vibrant colors" },
                { id: "as002", name: "FLAIR Acrylic marker", price: 359, img: "Screenshot_20250423_144509_Meesho.jpg", desc: "Premium acrylic paint markers, fine tip for detailed work" },
                { id: "as003", name: "Levin Acrylic Markers", price: 409, img: "Screenshot_20250423_140558_Meesho.jpg", desc: "Dual-tip acrylic markers with broad and fine tips" },
                { id: "as004", name: "Marker Set of 48", price: 299, img: "Touch-48-Color-Marker-Pen-Set-Kids-Art-Essentials-Double-Ended-Vibrant-Colors-Non-Bleeding-Wholesale-Discount-.webp", desc: "48-color marker set with dual tips for versatility" },
                { id: "as005", name: "Markers Set of 24", price: 179, img: "81B5uZXhYEL._AC_UF1000,1000_QL80_.jpg", desc: "24-color marker set, perfect for beginners" },
                { id: "as006", name: "Paint Brush 12 sizes", price: 99, img: "Screenshot_20250423_195924_Meesho.jpg", desc: "Professional paint brush set with 12 different sizes" },
                { id: "as007", name: "Sponge Dabbing Brush 5 Piece Set", price: 99, img: "41fvlzAzMWL._AC_.jpg", desc: "Sponge brush set for texture painting and special effects" },
                { id: "as008", name: "artist gesso + Decor varnish combo", price: 259, img: "camel-combo.jpg", desc: "Premium gesso (100ml) and varnish combo for art projects" }
            ],
            stationery: [
                { id: "st001", name: "Correction Tape", price: 70, img: "51l7S8XUY0L.jpg", desc: "Smooth correction tape for error-free writing" },
                { id: "st002", name: "Hot Melt Glue Gun ", price: 220, img: "71xHhYjWcIL.jpg", desc: "glue gun for more effective bond for crafts" },
                { id: "st003", name: "Sketch Kit", price: 619, img: "Screenshot_20250423_205027_Meesho.jpg", desc: "Complete sketching kit with pencils, erasers and sharpeners" },
                { id: "st004", name: "Luxury Pen", price: 199, img: "Screenshot_20250422_001401.jpg", desc: "Premium metal body pen with smooth ink flow" },
                { id: "st005", name: "Sketch book A5 (100pg)", price: 119, img: "Screenshot_20250423_204415_Meesho.jpg", desc: "A5 size sketchbook with 100gsm paper, 100 pages" }
            ],
            diaries: [
                { id: "di001", name: "Hardcover Diary", price: 249, img: "81EROqfMQBL._AC_UF1000,1000_QL80_.jpg", desc: "Classic hardcover diary with premium paper" },
                { id: "di002", name: "Premium  Diary", price: 319, img: "IMG-20250422-WA0005.jpg", desc: "Premium leather-bound diary" },
                { id: "di003", name: "Mini Diary", price: 219, img: "Screenshot_20250422_215326_Meesho.jpg", desc: "diary with compact size" },
                { id: "di004", name: "Vintage Leather Journal", price: 499, img: "Screenshot_20250426_225225_Amazon.jpg", desc: "Premium leather diary with good quality paper" }
            ],
            gadgets: [
                 { id: "ga001", name: "Mini Thermal Printer", price: 899, img: "placeholder-gadget.png", desc: "Compact thermal printer for labels, notes & fun prints. Bluetooth connectivity." }
            ]
        };

         // --- Coupon Data (Code: { type: 'percentage_discount' | 'fixed_discount' | 'percentage_increase', value: number }) ---
         const coupons = {
             "JIANSPECIAL": { type: "percentage_increase", value: 20 }, // 20% increase (Example from original code)
             "NSL10": { type: "percentage_discount", value: 10 } // 10% discount (Requested by user)
             // Add more coupons here
             // "FIXED50OFF": { type: "fixed_discount", value: 50 }
         };


        // --- State Variables ---
        let currentCategoryFilter = 'all';
        let orderItems = {}; // Stores product ID and quantity: { "productId": quantity, ... }


        // --- Utility Functions ---
        function escapeHtml(unsafe) {
            if (typeof unsafe !== 'string') return unsafe;
            return unsafe
                 .replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;")
                 .replace(/'/g, "&#039;");
        }

        function findProduct(id) {
            for (const categoryKey in products) {
                const product = products[categoryKey].find(p => p.id === id);
                if (product) {
                    // Return product details along with its category
                    return { ...product, category: categoryKey };
                }
            }
            return null; // Product not found
        }

         function saveCart() {
             try {
                 // Filter out items with quantity 0 before saving
                 const itemsToSave = Object.fromEntries(
                    Object.entries(orderItems).filter(([id, quantity]) => quantity > 0)
                 );
                 localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(itemsToSave));
                 console.log("Cart saved:", itemsToSave);
             } catch (e) {
                 console.error("Error saving cart to localStorage:", e);
             }
         }

         function loadCart() {
             try {
                 const savedCart = localStorage.getItem(CART_STORAGE_KEY);
                 if (savedCart) {
                     const parsedCart = JSON.parse(savedCart);
                     // Basic validation: Ensure it's an object and quantities are numbers > 0
                     if (typeof parsedCart === 'object' && parsedCart !== null) {
                          orderItems = Object.fromEntries(
                              Object.entries(parsedCart)
                                  .filter(([productId, quantity]) => findProduct(productId) && typeof quantity === 'number' && quantity > 0)
                          );
                         console.log("Cart loaded:", orderItems);
                     } else {
                          orderItems = {}; // Start with an empty cart if invalid data is found
                         console.warn("Invalid cart data found in localStorage, starting with empty cart.");
                     }
                 } else {
                     orderItems = {}; // Start with empty cart if nothing is in storage
                     console.log("No cart data found in localStorage, starting with empty cart.");
                 }
             } catch (e) {
                 console.error("Error loading cart from localStorage:", e);
                 orderItems = {}; // Start with empty cart on error
             }
         }


        // --- Product Rendering ---
        function renderProducts(category = 'all', searchTerm = '') {
            const container = document.getElementById("productsContainer");
            if (!container) { console.error("productsContainer not found!"); return; }

            container.innerHTML = '<div class="loader"></div>'; // Show loader

            // Use a small delay to allow loader to show and avoid blocking the UI
            setTimeout(() => {
                 try {
                    container.innerHTML = ''; // Clear loader/previous content
                    let hasProducts = false;
                    const searchTermLower = searchTerm.toLowerCase().trim();
                    currentCategoryFilter = category;

                    const createCategorySection = (catKey, items) => {
                        const filtered = items.filter(item =>
                            !searchTermLower ||
                            item.name.toLowerCase().includes(searchTermLower) ||
                            item.desc.toLowerCase().includes(searchTermLower)
                        );

                        if (filtered.length > 0) {
                            hasProducts = true;
                            const section = document.createElement('div');
                            section.className = 'mb-16';
                            const title = catKey.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                            if (category === 'all' || category === catKey) {
                                // Only add category title if displaying 'all' or the specific category
                                section.innerHTML = `<h3 class="category-title reveal">${escapeHtml(title)}</h3>`;
                            }

                            const grid = document.createElement('div');
                            grid.className = 'grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-8'; // Improved grid
                            grid.id = `${catKey}Grid`;
                            section.appendChild(grid);
                            container.appendChild(section);

                            filtered.forEach((product) => {
                                const card = createProductCard(product);
                                grid.appendChild(card);
                                observeElement(card); // Add to observer for reveal animation
                            });
                            // Observe title only if it's explicitly created for this category section
                            const categoryTitleElement = section.querySelector('.category-title');
                             if (categoryTitleElement) {
                                observeElement(categoryTitleElement);
                             }
                        }
                    };

                    if (category === 'all') {
                        Object.entries(products).forEach(([catKey, items]) => {
                            createCategorySection(catKey, items);
                        });
                    } else if (products[category]) {
                        // When filtering by a specific category, don't show the category title again within the section
                        createCategorySection(category, products[category]);
                    }

                    if (!hasProducts) {
                         container.innerHTML = '<p class="text-center text-gray-400 py-12 text-lg">No products found matching your criteria.</p>';
                    }

                 } catch (error) {
                    console.error("Error rendering products:", error);
                    container.innerHTML = '<p class="text-center text-red-500 py-12 text-lg">Error loading products. Please try again later.</p>';
                }
            }, 50); // Small timeout
        }


        function createProductCard(product) {
            const card = document.createElement("div");
            card.id = `product-${product.id}`; // Add ID for easy lookup
            card.className = "product-card reveal";
            card.setAttribute('data-product-id', product.id);

            const productNameSafe = escapeHtml(product.name);
            const productDescSafe = escapeHtml(product.desc);
            const productImgSafe = escapeHtml(product.img);

            const quantity = orderItems[product.id] || 0; // Get current quantity from state

            card.innerHTML = `
                <div class="product-image-wrapper">
                    <img src="${productImgSafe}" alt="${productNameSafe}" loading="lazy" class="product-img unselectable">
                </div>
                <div class="product-card-content">
                    <div>
                        <h3 title="${productNameSafe}">${productNameSafe}</h3>
                        <p class="product-desc" title="${productDescSafe}">${productDescSafe ? productDescSafe.substring(0, 120) + (productDescSafe.length > 120 ? '...' : '') : ''}</p> <span class="block product-price">${product.price}</span>
                    </div>
                </div>
                <div class="product-card-controls mt-auto">
                    ${quantity === 0
                        ? `<button type="button" class="btn btn-primary btn-add w-full" data-product-id="${product.id}">Add</button>`
                        : `
                            <div class="product-quantity-controls" data-product-id="${product.id}">
                                <button type="button" class="btn btn-secondary btn-small btn-decrease" data-product-id="${product.id}" aria-label="Decrease quantity">-</button>
                                <span class="product-quantity unselectable">${quantity}</span>
                                <button type="button" class="btn btn-secondary btn-small btn-increase" data-product-id="${product.id}" aria-label="Increase quantity">+</button>
                            </div>
                        `
                    }
                </div>
            `;

            // Make the card clickable for modal, but exclude quantity controls
            // This is handled by event delegation on the container

            return card;
        }

        // --- Order Management Functions ---
        function addItemToOrder(productId) {
            const product = findProduct(productId);
            if (!product) {
                console.error("Attempted to add non-existent product:", productId);
                return;
            }

            if (orderItems[productId]) {
                increaseQuantity(productId);
            } else {
                orderItems[productId] = 1;
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            }
             console.log('Order Items:', orderItems);
        }

        function increaseQuantity(productId) {
            const product = findProduct(productId);
             if (!product) {
                 console.error("Attempted to increase quantity for non-existent product:", productId);
                 return;
             }
            if (orderItems[productId] !== undefined) {
                orderItems[productId]++;
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            } else {
                 // This case shouldn't happen if UI is in sync with state, but handle defensively
                 addItemToOrder(productId);
            }
             console.log('Order Items:', orderItems);
        }

        function decreaseQuantity(productId) {
             const product = findProduct(productId);
             if (!product) {
                 console.error("Attempted to decrease quantity for non-existent product:", productId);
                 return;
             }
            if (orderItems[productId] !== undefined) {
                orderItems[productId]--;
                if (orderItems[productId] <= 0) {
                    delete orderItems[productId];
                }
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            }
             console.log('Order Items:', orderItems);
        }

        function updateProductCardUI(productId) {
            const card = document.getElementById(`product-${productId}`);
            if (!card) {
                 // console.warn(`Product card not found for ID: ${productId}. Cannot update UI.`);
                 // This might happen if the user is on a filtered/searched view and updates an item not currently displayed
                 // We don't need to block, just log a warning. The state is still updated.
                 return;
            }

            const controlsContainer = card.querySelector('.product-card-controls');
            const quantity = orderItems[productId] || 0;

            controlsContainer.innerHTML = ''; // Clear current controls

            if (quantity === 0) {
                controlsContainer.innerHTML = `<button type="button" class="btn btn-primary btn-add w-full" data-product-id="${productId}">Add</button>`;
            } else {
                 controlsContainer.innerHTML = `
                    <div class="product-quantity-controls" data-product-id="${productId}">
                        <button type="button" class="btn btn-secondary btn-small btn-decrease" data-product-id="${productId}" aria-label="Decrease quantity">-</button>
                                <span class="product-quantity unselectable">${quantity}</span>
                                <button type="button" class="btn btn-secondary btn-small btn-increase" data-product-id="${productId}" aria-label="Increase quantity">+</button>
                            </div>
                 `;
            }
             // Event listeners for these buttons are handled by delegation on productsContainer
        }


        function renderOrderSummary() {
             const summaryDisplay = document.getElementById('orderSummaryDisplay');
             const hiddenSummaryInput = document.getElementById('hiddenOrderSummary');
             const formSubjectInput = document.getElementById('formSubject');
             const couponCodeInput = document.getElementById('couponCode');
             const couponFeedback = document.getElementById('couponFeedback');
             const placeOrderBtn = document.getElementById('placeOrderBtn');


             if (!summaryDisplay || !hiddenSummaryInput || !formSubjectInput || !couponCodeInput || !couponFeedback || !placeOrderBtn) {
                 console.error("One or more order summary/coupon/button elements not found.");
                 return;
             }

             const productIds = Object.keys(orderItems);
             let subtotal = 0;
             let displayHTML = '';
             let hiddenText = 'Order Summary:\n\n';

             if (productIds.length === 0) {
                 displayHTML = '<p>Add items from the collection above to see your order here.</p>';
                 hiddenText = 'Order is empty.';
                 formSubjectInput.value = 'New Order from The Highon\'s Site (Empty)';
                  couponCodeInput.disabled = true; // Disable coupon input if cart is empty
                  couponCodeInput.value = ''; // Clear coupon input if cart becomes empty
                  couponFeedback.textContent = ''; // Clear feedback
                  placeOrderBtn.disabled = true; // Disable order button
             } else {
                  couponCodeInput.disabled = false; // Enable coupon input if items are in cart
                  placeOrderBtn.disabled = false; // Enable order button

                 displayHTML += '<ul>';
                 productIds.forEach(productId => {
                     const product = findProduct(productId);
                     const quantity = orderItems[productId];
                     if (product && quantity > 0) {
                         const itemTotal = product.price * quantity;
                         subtotal += itemTotal;
                         displayHTML += `
                            <li>
                                <span class="order-item-name">${escapeHtml(product.name)}</span>
                                <span class="order-item-quantity">x ${quantity}</span>
                                <span class="order-item-price">${itemTotal.toFixed(2)}</span>
                            </li>
                         `;
                          hiddenText += `- ${escapeHtml(product.name)} x ${quantity} (${product.price.toFixed(2)} each = ${itemTotal.toFixed(2)})\n`;
                     }
                 });
                 displayHTML += '</ul>';

                 // Display Subtotal
                 displayHTML += `<div class="order-summary-line"><span>Subtotal:</span> <span>${subtotal.toFixed(2)}</span></div>`;
                 hiddenText += `\nSubtotal: ${subtotal.toFixed(2)}`;


                 // --- Apply Coupon Logic ---
                 let finalTotal = subtotal;
                 let priceAdjustment = 0; // Can be positive (increase) or negative (discount)
                 let feedbackMessage = '';
                 let adjustmentLineHTML = '';
                 let hiddenAdjustmentText = '';
                 let couponApplied = false;

                 const enteredCouponCode = couponCodeInput.value.trim().toUpperCase(); // Case-insensitive

                 if (enteredCouponCode) {
                     const coupon = coupons[enteredCouponCode];
                     if (coupon) {
                          couponApplied = true;
                         if (coupon.type === 'percentage_increase') {
                             priceAdjustment = subtotal * (coupon.value / 100);
                             finalTotal = subtotal + priceAdjustment;
                             feedbackMessage = `Coupon "${enteredCouponCode}" applied: +${coupon.value}% increase.`;
                             adjustmentLineHTML = `<div class="order-summary-line increase-line"><span>Coupon (${enteredCouponCode}):</span> <span>+${priceAdjustment.toFixed(2)}</span></div>`;
                             hiddenAdjustmentText = `\nCoupon Applied: ${enteredCouponCode} (+${coupon.value}% Increase) +${priceAdjustment.toFixed(2)}`;
                              couponFeedback.style.color = 'var(--danger-color)'; // Red for increase
                         } else if (coupon.type === 'percentage_discount') {
                             priceAdjustment = subtotal * (coupon.value / 100);
                             finalTotal = subtotal - priceAdjustment;
                             feedbackMessage = `Coupon "${enteredCouponCode}" applied: ${coupon.value}% off!`;
                             adjustmentLineHTML = `<div class="order-summary-line discount-line"><span>Coupon (${enteredCouponCode}):</span> <span>-${priceAdjustment.toFixed(2)}</span></div>`;
                             hiddenAdjustmentText = `\nCoupon Applied: ${enteredCouponCode} (-${coupon.value}% Discount) -${priceAdjustment.toFixed(2)}`;
                              couponFeedback.style.color = 'var(--success-color)'; // Green for discount
                         } else if (coupon.type === 'fixed_discount') {
                             priceAdjustment = coupon.value;
                             finalTotal = subtotal - priceAdjustment;
                             feedbackMessage = `Coupon "${enteredCouponCode}" applied: ${coupon.value} off!`;
                             adjustmentLineHTML = `<div class="order-summary-line discount-line"><span>Coupon (${enteredCouponCode}):</span> <span>-${priceAdjustment.toFixed(2)}</span></div>`;
                             hiddenAdjustmentText = `\nCoupon Applied: ${enteredCouponCode} (${coupon.value} Fixed Discount) -${priceAdjustment.toFixed(2)}`;
                             couponFeedback.style.color = 'var(--success-color)'; // Green for discount
                         }
                         else {
                             feedbackMessage = `Coupon "${enteredCouponCode}" has an unknown type.`;
                             couponApplied = false; // Mark as not applied if type is unknown
                              couponFeedback.style.color = 'var(--text-secondary)'; // Default color
                         }
                     } else {
                         feedbackMessage = `Invalid coupon code: "${enteredCouponCode}"`;
                          couponFeedback.style.color = 'var(--text-secondary)'; // Default color
                     }
                 } else {
                     // No coupon code entered or code was cleared
                     feedbackMessage = ''; // Clear feedback
                      couponFeedback.style.color = 'var(--text-secondary)'; // Default color
                 }

                 // Ensure total doesn't go below zero due to fixed discounts (percentage discounts won't)
                 finalTotal = Math.max(0, finalTotal);

                 // Append adjustment line if applicable
                 if (adjustmentLineHTML) {
                     displayHTML += adjustmentLineHTML;
                 }
                 couponFeedback.textContent = feedbackMessage;
                 hiddenText += hiddenAdjustmentText;


                 // Display Final Total
                 displayHTML += `<div class="order-total">Final Total: ${finalTotal.toFixed(2)}</div>`;
                 hiddenText += `\nFinal Total: ${finalTotal.toFixed(2)}`;

                 // Update form subject with final total and coupon status
                 formSubjectInput.value = `New Order from The Highon's Site (Final ${finalTotal.toFixed(2)})` + (couponApplied ? ` - Coupon: ${enteredCouponCode}` : '');

             }

             summaryDisplay.innerHTML = displayHTML;
             // Update the value of the hidden input field
             hiddenSummaryInput.value = hiddenText;
        }

        // --- User Details Management (using localStorage) ---
        function loadUserDetails() {
            const userDetails = localStorage.getItem(USER_DETAILS_STORAGE_KEY);
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');
            const forgetButton = document.getElementById('forgetMyDetailsBtn');

            if (userDetails && nameInput && emailInput && phoneInput && addressInput && forgetButton) {
                try {
                    const parsedDetails = JSON.parse(userDetails);
                    // Populate if data exists and is not empty
                    if (parsedDetails.name || parsedDetails.email || parsedDetails.phone || parsedDetails.address) {
                        nameInput.value = parsedDetails.name || '';
                        emailInput.value = parsedDetails.email || '';
                        phoneInput.value = parsedDetails.phone || '';
                        addressInput.value = parsedDetails.address || '';
                        forgetButton.classList.remove('hidden'); // Show forget button
                    } else {
                         forgetButton.classList.add('hidden'); // Hide if data is empty object
                    }
                } catch (e) {
                    console.error("Error parsing user details from localStorage", e);
                    clearUserDetails(); // Clear invalid data
                }
            } else if (forgetButton) {
                 forgetButton.classList.add('hidden'); // Hide forget button if no data or elements missing
            }
        }

        function saveUserDetails() {
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');

            if (nameInput && emailInput && phoneInput && addressInput) {
                const userDetails = {
                    name: nameInput.value.trim(),
                    email: emailInput.value.trim(),
                    phone: phoneInput.value.trim(),
                    address: addressInput.value.trim()
                };
                 // Save only if required fields are provided
                 if(userDetails.name && userDetails.email && userDetails.phone && userDetails.address) {
                    try {
                         localStorage.setItem(USER_DETAILS_STORAGE_KEY, JSON.stringify(userDetails));
                         console.log("User details saved.");
                         // Show forget button after saving
                          const forgetButton = document.getElementById('forgetMyDetailsBtn');
                          if(forgetButton) forgetButton.classList.remove('hidden');
                    } catch (e) {
                         console.error("Error saving user details to localStorage:", e);
                    }
                 } else {
                     console.log("User details not saved: Required fields missing.");
                 }
            }
        }

        function clearUserDetails() {
            localStorage.removeItem(USER_DETAILS_STORAGE_KEY);
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');
             const forgetButton = document.getElementById('forgetMyDetailsBtn');


            if (nameInput) nameInput.value = '';
            if (emailInput) emailInput.value = '';
            if (phoneInput) phoneInput.value = '';
            if (addressInput) addressInput.value = '';
            if (forgetButton) forgetButton.classList.add('hidden');

            console.log("User details cleared from localStorage.");
        }


        // --- UI Interaction Functions ---

        function showModal(productId) {
           try {
                const product = findProduct(productId);
                if (!product) {
                    console.error("Product not found for modal:", productId);
                    return;
                }

                const modalImg = document.getElementById('modalImg');
                const modalName = document.getElementById('modalName');
                const modalDesc = document.getElementById('modalDesc');
                const modalPrice = document.getElementById('modalPrice');
                const productModal = document.getElementById('productModal');

                if (!modalImg || !modalName || !modalDesc || !modalPrice || !productModal) {
                     console.error("Modal elements missing!");
                     return;
                }

                modalImg.src = escapeHtml(product.img);
                modalImg.alt = escapeHtml(product.name);
                modalName.textContent = escapeHtml(product.name);
                modalDesc.textContent = escapeHtml(product.desc);
                modalPrice.textContent = `${product.price}`;

                // Add class for animation and make visible
                productModal.classList.remove('hidden');
                 // Allow transition to complete before setting opacity
                 requestAnimationFrame(() => {
                     productModal.classList.add('opacity-100', 'pointer-events-auto');
                      productModal.querySelector('.modal-content').classList.remove('scale-95'); // Reset scale for transition
                 });

                document.body.classList.add('overflow-hidden'); // Prevent body scroll

           } catch (error) {
                console.error("Error showing modal:", error);
                closeModal(); // Attempt to close modal on error
           }
        }

        function closeModal() {
          const productModal = document.getElementById('productModal');
           if (!productModal) {
               console.error("Modal element not found for closing.");
               return;
           }

           // Add classes for animation and hide
           productModal.classList.remove('opacity-100', 'pointer-events-auto');
           productModal.querySelector('.modal-content').classList.add('scale-95'); // Scale down for transition

           // Use a timeout to hide the modal after the transition completes
           productModal.addEventListener('transitionend', function handler() {
               productModal.classList.add('hidden');
               productModal.removeEventListener('transitionend', handler);
               document.body.classList.remove('overflow-hidden'); // Re-enable body scroll
                // Reset modal content for next open
                const modalImg = document.getElementById('modalImg');
                if(modalImg) modalImg.src = '';
           });
        }

        function toggleMobileMenu() {
          const mobileMenu = document.getElementById('mobileMenu');
          if (mobileMenu) {
            mobileMenu.classList.toggle('hidden');
          }
        }


        // --- Scroll Animation Observer ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    // Optional: unobserve after revealing to save resources
                    // observer.unobserve(entry.target);
                }
            });
        }, {
            threshold: 0.1 // Trigger when 10% of the element is visible
        });
        function observeElement(element) {
            if (element) {
                // Check if element already has the reveal class and is visible before observing
                 // This prevents re-observing elements that are already animated
                 if (!element.classList.contains('visible')) {
                     element.classList.add('reveal'); // Ensure reveal class is present
                     observer.observe(element);
                 }
            }
        }

         // --- Scroll spy for active nav link ---
         const sections = document.querySelectorAll('section[id]');
         const navLinks = document.querySelectorAll('.nav-link');

         function scrollSpy() {
             let current = '';
             sections.forEach(section => {
                 const sectionTop = section.offsetTop;
                 const sectionHeight = section.clientHeight;
                 // Adjust offset based on header height (approx 80px)
                 if (pageYOffset >= sectionTop - 80) {
                     current = section.getAttribute('id');
                 }
             });

             navLinks.forEach(link => {
                 link.classList.remove('active');
                 if (link.href.includes(`#${current}`)) {
                     link.classList.add('active');
                 }
             });
         }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
          try {
              // Set footer year
              const footerYear = document.getElementById('footerYear');
              if (footerYear) footerYear.textContent = new Date().getFullYear();

              // Load cart and user details from local storage
              loadCart();
              loadUserDetails();

              // Initial render of products and order summary based on loaded cart
              renderProducts('all', ''); // Pass initial filter and search terms
              renderOrderSummary();


              // --- Event Listeners Setup ---

              // Product Search Input
              const productSearchInput = document.getElementById('productSearch');
              if (productSearchInput) {
                   let searchTimeout;
                   productSearchInput.addEventListener('input', function() {
                       clearTimeout(searchTimeout);
                       const searchTerm = this.value;
                       searchTimeout = setTimeout(() => {
                           renderProducts(currentCategoryFilter, searchTerm); // Use current filter
                       }, 300); // Debounce search
                   });
              } else { console.error("Product search input not found."); }

              // Category Filter Select
              const categoryFilterSelect = document.getElementById('categoryFilter');
              if (categoryFilterSelect) {
                   categoryFilterSelect.addEventListener('change', function() {
                      const searchVal = document.getElementById('productSearch')?.value || '';
                      renderProducts(this.value, searchVal); // Use current search term
                   });
              } else { console.error("Category filter select not found."); }

               // Modal close on background click
               const productModal = document.getElementById('productModal');
               if (productModal) {
                   productModal.addEventListener('click', (event) => {
                       // Check if the click occurred directly on the backdrop
                       if (event.target === productModal) {
                           closeModal();
                       }
                   });
               } else { console.error("Product modal element not found."); }

               // --- Event Delegation for Product Card Controls and Modal Trigger ---
               const productsContainer = document.getElementById('productsContainer');
               if (productsContainer) {
                   productsContainer.addEventListener('click', (event) => {
                       const target = event.target;
                       // Find the closest product card element to get the product ID
                       const productCard = target.closest('.product-card');

                       if (!productCard) return; // Not inside a product card

                       const productId = productCard.getAttribute('data-product-id');
                       if (!productId) {
                           console.warn("Clicked element inside product card has no product ID:", target);
                           return; // Product ID missing
                       }

                       // Check if the click was on a specific button class within controls
                       const isControlClick = target.closest('.product-quantity-controls') || target.classList.contains('btn-add');

                       if (target.classList.contains('btn-add')) {
                           addItemToOrder(productId);
                       } else if (target.classList.contains('btn-increase')) {
                           increaseQuantity(productId);
                       } else if (target.classList.contains('btn-decrease')) {
                           decreaseQuantity(productId);
                       } else if (!isControlClick) {
                           // If not a quantity button or the add button itself, show the modal
                           // This covers clicks on the image, title, description, price
                            showModal(productId);
                       }
                       // If it was a control click, the specific button handlers already ran
                   });
               } else { console.error("productsContainer not found for event delegation."); }

                // --- Coupon Input Listener ---
                const couponCodeInput = document.getElementById('couponCode');
                if (couponCodeInput) {
                    couponCodeInput.addEventListener('input', renderOrderSummary); // Update summary on input change
                } else { console.error("Coupon code input not found."); }


               // --- Order Form Submission Listener ---
               const orderForm = document.getElementById('orderForm');
               if (orderForm) {
                   orderForm.addEventListener('submit', function(event) {
                       // Basic validation: Check if any items are in the order
                       if (Object.keys(orderItems).length === 0) {
                            alert("Your order list is empty. Please add items from the collection before placing an order.");
                            event.preventDefault(); // Prevent form submission
                            return; // Stop here if order is empty
                       }

                        // Save user details before submitting
                       saveUserDetails();

                       // Ensure the hidden order summary is populated just before submitting
                       // This also re-calculates based on the final coupon input value
                       renderOrderSummary();

                       // Optional: Disable the submit button to prevent double clicks
                       const submitButton = orderForm.querySelector('button[type="submit"]');
                       if(submitButton) {
                           submitButton.disabled = true;
                           submitButton.textContent = 'Placing Order...';
                       }
                       // FormSubmit.co handles the actual AJAX submission or page redirect
                   });
               } else { console.error("Order form not found."); }

                // --- Forget My Details Button Listener ---
                const forgetButton = document.getElementById('forgetMyDetailsBtn');
                if(forgetButton) {
                    forgetButton.addEventListener('click', clearUserDetails);
                }

                // --- Scroll Spy Listener ---
                 window.addEventListener('scroll', scrollSpy);
                 // Initial call to set active link on page load
                 scrollSpy();


               // Observe elements with 'reveal' class initially present in HTML
                document.querySelectorAll('.reveal').forEach(el => observeElement(el));


          } catch (error) {
               console.error("Critical error during DOMContentLoaded initialization:", error);
               // Use a more robust error display
               const errorDiv = document.createElement('div');
               errorDiv.style.cssText = "padding: 40px; text-align: center; font-family: sans-serif; color: white; background-color: #333; margin: 20px; border-radius: 8px;";
               errorDiv.innerHTML = `<h1>Oops!</h1><p>Something went wrong while loading the page content.</p><p>Please <a href="javascript:location.reload();" style="color: var(--primary-accent); text-decoration: underline;">refresh</a> and try again.</p><p style="font-size: 0.8em; color: var(--text-secondary);">Error details: ${escapeHtml(error.message)}</p>`;
               document.body.innerHTML = ''; // Clear existing body content
               document.body.appendChild(errorDiv);
          }
        });
    </script>

</body>
</html>
