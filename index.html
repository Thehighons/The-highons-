<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="The Highon's - Premium creative supplies including keychains, art supplies, stationery, gadgets, and diaries available for inquiry in Navsari.">
    <title>The Highon's - Premium Creative Supplies | Navsari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
          --bg-dark: #111; /* Kept dark background */
          --text-main: #F2F0EA; /* Cream for main text */
          --text-secondary: #AAA; /* Kept secondary text color for contrast */
          --primary-accent: #A8D5E3; /* Teal as primary accent */
          --secondary-accent: #FF78AC; /* Pink as secondary accent */
          --card-bg: #1A1A1A; /* Kept dark card background */
          --border-color: rgba(168, 213, 227, 0.3); /* Transparent Teal border */
           --danger-color: #E57373; /* Kept danger color */
           --success-color: #81C784; /* Kept success color */
        }

        html {
          scroll-behavior: smooth;
        }

        body {
          font-family: 'Inter', sans-serif;
          background-color: var(--bg-dark);
          color: var(--text-main);
          overflow-x: hidden;
        }
        /* Prevent body scroll when modal is open */
        body.overflow-hidden {
            overflow: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
          font-family: 'Roboto', sans-serif;
          color: var(--text-main);
          font-weight: 700;
        }
        .brand-name {
          font-family: 'Roboto', sans-serif;
          letter-spacing: 2px;
          color: var(--primary-accent);
          font-weight: 700;
        }

        header {
          background-color: rgba(17, 17, 17, 0.9);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border-bottom: 1px solid var(--border-color);
        }

        .nav-link {
          position: relative;
          color: var(--text-secondary);
          transition: all 0.3s ease;
          padding: 0.5rem 0.25rem;
          font-weight: 500;
          letter-spacing: 1px;
        }
        .nav-link:hover {
          color: var(--primary-accent);
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background-color: var(--secondary-accent);
            transition: all 0.3s ease;
            transform: translateX(-50%);
            border-radius: 1px;
        }
        .nav-link:hover::after {
            width: 70%;
        }

        .hero-section {
            position: relative;
            overflow: hidden;
            background: linear-gradient(to bottom, var(--bg-dark) 0%, #000 100%);
        }
        .hero-shapes div {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-accent), var(--secondary-accent));
            opacity: 0.05;
            animation: drift 25s infinite linear alternate;
        }
        .hero-shapes div:nth-child(1) { width: 200px; height: 200px; top: 5%; left: 10%; animation-duration: 28s;}
        .hero-shapes div:nth-child(2) { width: 100px; height: 100px; top: 75%; left: 85%; animation-duration: 20s; animation-delay: 3s;}
        .hero-shapes div:nth-child(3) { width: 150px; height: 150px; top: 30%; left: 40%; animation-duration: 30s; animation-delay: 5s;}

        @keyframes drift {
            from { transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); }
            to { transform: translateY(30px) translateX(-20px) rotate(45deg) scale(1.1); }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.8rem 2rem;
            border-radius: 3px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            border: none;
            position: relative;
            overflow: hidden;
            z-index: 1;
            white-space: nowrap;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
         .btn::before {
             content: "";
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.1), transparent);
             transition: left 0.6s ease;
             z-index: -1;
         }
         .btn:hover::before {
             left: 100%;
         }


        .btn-primary {
            background-color: var(--primary-accent);
            color: var(--bg-dark);
            box-shadow: 0 4px 15px rgba(168, 213, 227, 0.3); /* Updated shadow color */
        }
        .btn-primary:hover {
            background-color: var(--secondary-accent); /* Pink on hover */
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 120, 172, 0.4); /* Updated shadow color */
        }
         .btn-primary:disabled {
             opacity: 0.5;
             cursor: not-allowed;
             transform: none;
             box-shadow: none;
         }
          .btn-primary:disabled::before {
               left: -100%;
          }


        .btn-secondary {
            background-color: transparent;
            color: var(--primary-accent);
            border: 1px solid var(--primary-accent);
            box-shadow: none;
        }
        .btn-secondary:hover {
            background-color: rgba(168, 213, 227, 0.1); /* Transparent Teal on hover */
            transform: translateY(-1px);
        }

         .btn-small {
             padding: 0.3rem 0.6rem;
             font-size: 0.8rem;
             border-radius: 2px;
         }


        #products {
            background: linear-gradient(to bottom, var(--bg-dark), #000);
            position: relative;
            padding-top: 6rem;
            padding-bottom: 6rem;
         }

        .category-title {
            background: none;
            color: var(--primary-accent);
            padding: 0;
            border-radius: 0;
            display: block;
            text-align: left;
            margin: 40px 0 20px 0;
            box-shadow: none;
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            border-bottom: 1px solid var(--border-color);
             padding-bottom: 10px;
             text-transform: uppercase;
        }

        .product-card {
            background-color: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            transform-style: preserve-3d;
            box-shadow: 0 2px 10px rgba(0,0,0, 0.4);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
             cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0, 0.6);
            border-color: var(--primary-accent);
        }

        .product-image-wrapper {
            height: 220px;
            background-color: rgba(255, 255, 255, 0.03);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            overflow: hidden;
        }
        .product-image-wrapper img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
        .product-card:hover .product-image-wrapper img {
            transform: scale(1.05);
        }

        .product-card-content {
            padding: 1rem;
            text-align: left;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        .product-card h3 {
            font-family: 'Roboto', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
            color: var(--text-main);
            min-height: 2.6em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
             text-transform: uppercase;
             letter-spacing: 0.5px;
        }
         .product-card p.product-desc {
             font-family: 'Inter', sans-serif;
             font-size: 0.8rem;
             color: var(--text-secondary);
             margin-bottom: 0.8rem;
             min-height: 3em;
             display: -webkit-box;
             -webkit-line-clamp: 3;
             -webkit-box-orient: vertical;
             overflow: hidden;
             text-overflow: ellipsis;
         }
        .product-card .product-price-info {
            margin-bottom: 1rem;
        }
         .product-card .product-price-info .original-price {
            font-family: 'Roboto', sans-serif;
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-decoration: line-through;
            margin-right: 8px;
         }
         .product-card .product-price-info .discounted-price {
            font-family: 'Roboto', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--secondary-accent); /* Pink for discounted price */
            display: inline-block;
         }
         .product-card .product-price-info .discount-percentage {
             font-family: 'Inter', sans-serif;
             font-size: 0.75rem;
             font-weight: 600;
             color: var(--success-color);
             margin-left: 5px;
             vertical-align: top;
             white-space: nowrap;
         }


        .product-card-controls {
            padding: 0 1rem 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .product-quantity-controls {
             display: flex;
             align-items: center;
             gap: 0.5rem;
             width: 100%;
             justify-content: center;
        }
         .product-quantity {
             font-family: 'Roboto', sans-serif;
             font-size: 1rem;
             font-weight: 700;
             color: var(--text-main);
             min-width: 25px;
             text-align: center;
         }

        #productSearch, #categoryFilter, #couponCode {
            background-color: var(--card-bg);
            color: var(--text-main);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            padding: 0.8rem 1.2rem;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
        }
         #productSearch::placeholder, #couponCode::placeholder {
             color: var(--text-secondary);
             opacity: 0.7;
         }
        #productSearch { padding-left: 2.5rem; }
        #categoryFilter {
          appearance: none;
          background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%23AAAAAA"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 0 01-1.414 0l-4-4a1 0 010-1.414z" clip-rule="evenodd" /></svg>');
          background-repeat: no-repeat;
          background-position: right 1rem center;
          background-size: 0.9em 0.9em;
          padding-right: 2.5rem;
        }
         #categoryFilter option {
             background-color: var(--bg-dark);
             color: var(--text-main);
         }

        #productSearch:focus, #categoryFilter:focus, #couponCode:focus {
             border-color: var(--primary-accent); /* Teal focus border */
             box-shadow: 0 0 0 1px rgba(168, 213, 227, 0.5); /* Transparent Teal shadow */
             outline: none;
             background-color: rgba(26, 26, 26, 0.9);
        }
         #couponCode:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             background-color: rgba(26, 26, 26, 0.5);
         }
        .search-icon { color: var(--text-secondary); left: 1rem; font-size: 0.9rem;}

        .form-section {
            background-color: var(--bg-dark);
            position: relative;
            overflow: hidden;
            padding-top: 6rem;
            padding-bottom: 6rem;
        }

        .form-container {
            background-color: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            padding: 2.5rem;
            position: relative;
            z-index: 1;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }
        .form-container label {
             color: var(--text-secondary);
             font-weight: 500;
             font-size: 0.85rem;
             margin-bottom: 0.4rem;
             display: block;
              text-transform: uppercase;
              letter-spacing: 0.5px;
         }
        .form-container input[type="text"],
        .form-container input[type="email"],
        .form-container input[type="tel"],
        .form-container textarea,
        .form-container select {
            background-color: rgba(26, 26, 26, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-main);
            border-radius: 3px;
            padding: 0.9rem 1rem;
             width: 100%;
             transition: all 0.3s ease;
             font-family: 'Inter', sans-serif;
             font-size: 0.9rem;
        }
        .form-container input::placeholder,
        .form-container textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }
        .form-container input:focus,
        .form-container textarea:focus,
        .form-container select:focus {
            border-color: var(--primary-accent); /* Teal focus border */
            background-color: rgba(26, 26, 26, 0.9);
             box-shadow: 0 0 0 1px rgba(168, 213, 227, 0.5); /* Transparent Teal shadow */
             outline: none;
        }
         .form-container select option {
             background-color: var(--bg-dark);
             color: var(--text-main);
         }

         #orderSummaryDisplay {
             background-color: rgba(26, 26, 26, 0.7);
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 5px;
             padding: 1.2rem;
             margin-bottom: 1.5rem;
             min-height: 80px;
             color: var(--text-main);
             font-size: 0.9rem;
         }
         #orderSummaryDisplay p {
             color: var(--text-secondary);
             text-align: center;
         }
         #orderSummaryDisplay ul {
             list-style: none;
             padding: 0;
             margin: 0;
         }
         #orderSummaryDisplay li {
             padding: 0.6rem 0;
             border-bottom: 1px dashed rgba(255, 255, 255, 0.08);
              display: flex;
              justify-content: space-between;
              align-items: center;
         }
         #orderSummaryDisplay li:last-child {
             border-bottom: none;
         }
         #orderSummaryDisplay .order-item-name {
             font-weight: 600;
             color: var(--text-main);
             flex-grow: 1;
             margin-right: 0.8rem;
         }
         #orderSummaryDisplay .order-item-quantity {
              color: var(--text-secondary);
              font-size: 0.8rem;
         }
         #orderSummaryDisplay .order-item-price {
              font-weight: 500;
              color: var(--text-main);
              min-width: 60px;
              text-align: right;
         }
          #orderSummaryDisplay .order-summary-line {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 0.6rem 0;
               border-bottom: 1px dashed rgba(255, 255, 255, 0.08);
          }
          #orderSummaryDisplay .order-summary-line:last-child {
              border-bottom: none;
          }

         #orderSummaryDisplay .order-total {
              font-size: 1.3rem;
              font-weight: 700;
              color: var(--secondary-accent); /* Pink for total */
              margin-top: 1.2rem;
              text-align: right;
              padding-top: 0.8rem;
              border-top: 1px solid rgba(255, 255, 255, 0.1);
         }
         #orderSummaryDisplay .discount-line {
             color: var(--success-color);
         }
          #orderSummaryDisplay .increase-line {
              color: var(--danger-color);
          }


        #contact {
            background-color: var(--card-bg);
            padding-top: 6rem;
            padding-bottom: 6rem;
        }
        .contact-info-box {
             background-color: rgba(26, 26, 26, 0.8);
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 5px;
             padding: 2.5rem;
             transition: all 0.3s ease;
        }
        .contact-info-box:hover {
             border-color: var(--primary-accent); /* Teal hover border */
             transform: translateY(-3px);
             box-shadow: 0 6px 15px rgba(0,0,0,0.35);
        }
        .contact-info-box h3 {
             text-align: left;
             border-bottom: 1px solid var(--border-color); /* Transparent Teal border */
             padding-bottom: 10px;
             margin-bottom: 20px;
        }
        .contact-info-box a {
            color: var(--primary-accent); /* Teal links */
            transition: color 0.3s ease;
            word-break: break-all;
        }
        .contact-info-box a:hover {
            color: var(--secondary-accent); /* Pink on hover */
        }
        .social-icons a {
            color: var(--text-secondary);
            font-size: 2rem;
            transition: all 0.3s ease;
        }
        .social-icons a:hover {
             color: var(--primary-accent); /* Teal on hover */
             transform: scale(1.1);
        }

        footer {
            background-color: var(--bg-dark);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        footer .brand-name { color: var(--primary-accent); /* Teal brand name */ }
        footer a { color: var(--text-secondary); transition: color 0.3s ease; }
        footer a:hover { color: var(--primary-accent); /* Teal links on hover */ }
        footer .text-gray-500 { color: var(--text-secondary); opacity: 0.7; font-size: 0.75rem; }

        /* Modal Styling (Reused for both product and terms) */
        .modal-backdrop {
             background-color: rgba(0, 0, 0, 0.8);
             backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: var(--text-main);
             box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
             padding: 2.5rem; /* Standard padding */
        }
        .modal-content img { border-radius: 3px; background-color: rgba(255, 255, 255, 0.03); padding: 0.5rem; }
        .modal-content h3 { color: var(--text-main); font-family: 'Roboto', sans-serif; font-size: 1.8rem; font-weight: 700; }
        .modal-content p { color: var(--text-secondary); font-family: 'Inter', sans-serif; font-size: 0.9rem; }
        .modal-content .modal-price { color: var(--secondary-accent); /* Pink price in modal */ font-family: 'Roboto', sans-serif; font-size: 2rem; font-weight: 700;}
        .modal-close-btn {
            color: var(--text-secondary);
            transition: all 0.3s ease;
             font-size: 2rem;
             position: absolute;
             top: 1rem; /* Adjusted position */
             right: 1rem; /* Adjusted position */
             line-height: 1; /* Ensure 'x' is centered vertically */
             padding: 0.5rem; /* Make clickable area larger */
        }
        .modal-close-btn:hover {
             color: var(--primary-accent); /* Teal on hover */
             transform: rotate(0deg);
        }
         .modal-price-info {
            margin-bottom: 1.5rem; /* Increased space */
         }
         .modal-price-info .original-price {
            font-family: 'Roboto', sans-serif;
            font-size: 1rem; /* Slightly larger */
            color: var(--text-secondary);
            text-decoration: line-through;
            margin-right: 10px;
         }
         .modal-price-info .discounted-price {
            font-family: 'Roboto', sans-serif;
            font-size: 2rem; /* Matches modal-price */
            font-weight: 700;
            color: var(--secondary-accent); /* Pink price in modal */
            display: inline-block;
         }
         .modal-price-info .discount-percentage {
             font-family: 'Inter', sans-serif;
             font-size: 0.9rem; /* Slightly larger */
             font-weight: 600;
             color: var(--success-color);
             margin-left: 8px;
             vertical-align: top;
             white-space: nowrap;
         }


        /* Specific styling for Terms Modal Content */
        #termsModal .modal-content {
            text-align: center;
            max-width: 500px; /* Narrower for a pop-up feel */
             padding: 3rem 2rem; /* More padding */
        }
         #termsModal .modal-content h3 {
             font-size: 1.5rem; /* Smaller title */
             margin-bottom: 1.5rem;
         }
         #termsModal .modal-content p {
             font-size: 1rem; /* Slightly larger text */
             line-height: 1.6;
             margin-bottom: 2rem;
         }
          #termsModal .modal-content a {
              color: var(--primary-accent); /* Teal links */
              text-decoration: underline;
              transition: color 0.3s ease;
          }
           #termsModal .modal-content a:hover {
               color: var(--secondary-accent); /* Pink on hover */
           }


        /* Full Terms and Conditions Section */
        #termsAndConditionsFull {
             position: fixed;
             inset: 0;
             z-index: 90; /* Higher than modals */
             background-color: var(--bg-dark);
             color: var(--text-main);
             overflow-y: auto;
             padding: 80px 20px 40px 20px; /* Padding top for header, bottom for content */
             transition: opacity 0.3s ease;
        }
         #termsAndConditionsFull .full-terms-container {
             max-width: 800px; /* Readable width */
             margin: 0 auto;
             padding-top: 20px; /* Space below title */
         }
         #termsAndConditionsFull h2 {
             font-size: 2.5rem;
             text-align: center;
             margin-bottom: 1.5rem;
             color: var(--primary-accent); /* Teal title */
             border-bottom: 1px solid var(--border-color); /* Transparent Teal border */
             padding-bottom: 15px;
         }
          #termsAndConditionsFull h3 {
             font-size: 1.5rem;
             margin-top: 1.5rem;
             margin-bottom: 0.8rem;
             color: var(--text-main);
          }
         #termsAndConditionsFull p, #termsAndConditionsFull li {
             font-family: 'Inter', sans-serif;
             font-size: 0.95rem;
             line-height: 1.7;
             color: var(--text-secondary);
             margin-bottom: 1rem;
         }
          #termsAndConditionsFull ul {
              list-style: disc inside;
              padding-left: 1.5rem;
              margin-bottom: 1rem;
          }
          #termsAndConditionsFull a {
             color: var(--primary-accent); /* Teal links */
             text-decoration: underline;
             transition: color 0.3s ease;
          }
           #termsAndConditionsFull a:hover {
              color: var(--secondary-accent); /* Pink on hover */
           }

         #termsAndConditionsFull .btn-back {
             margin-top: 2rem;
             display: inline-block; /* Center the button */
             margin-left: auto;
             margin-right: auto;
         }


        .loader {
          border: 4px solid rgba(255, 255, 255, 0.1);
          border-top: 4px solid var(--primary-accent); /* Teal loader */
          border-radius: 50%;
          width: 50px;
          height: 50px;
          animation: spin 1s linear infinite;
          margin: 80px auto;
        }
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        .reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            transition-delay: 0s;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

        #orderFormContainer {
             background-color: var(--card-bg);
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 5px;
             padding: 2.5rem;
             position: relative;
             z-index: 1;
             box-shadow: 0 10px 25px rgba(0,0,0,0.3);
             max-width: 700px;
             margin: 0 auto;
        }
         #orderFormContainer label {
             color: var(--text-secondary);
             font-weight: 500;
             font-size: 0.85rem;
             margin-bottom: 0.4rem;
             display: block;
              text-transform: uppercase;
              letter-spacing: 0.5px;
         }
         #orderFormContainer input[type="text"],
         #orderFormContainer input[type="email"],
         #orderFormContainer input[type="tel"],
         #orderFormContainer textarea,
         #orderFormContainer select {
            background-color: rgba(26, 26, 26, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-main);
            border-radius: 3px;
            padding: 0.9rem 1rem;
             width: 100%;
             transition: all 0.3s ease;
             font-family: 'Inter', sans-serif;
             font-size: 0.9rem;
        }
        #orderFormContainer input::placeholder,
        #orderFormContainer textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }
        #orderFormContainer input:focus,
        #orderFormContainer textarea:focus,
        #orderFormContainer select:focus {
            border-color: var(--primary-accent); /* Teal focus border */
            background-color: rgba(26, 26, 26, 0.9);
             box-shadow: 0 0 0 1px rgba(168, 213, 227, 0.5); /* Transparent Teal shadow */
             outline: none;
        }
         #orderFormContainer select option {
             background-color: var(--bg-dark);
             color: var(--text-main);
         }
         #orderFormContainer .btn-primary {
             margin-top: 1.5rem;
         }
         #orderFormContainer .text-gray-500 {
              color: var(--text-secondary);
         }


         /* Added Styles for Order Submission Messages/Instructions */
          #orderSuccessMessage.hidden,
          #upiPaymentInstructions.hidden {
              display: none;
          }
          #orderSuccessMessage,
          #upiPaymentInstructions {
               margin-top: 1.5rem;
               padding: 1.5rem;
               border-radius: 5px;
               box-shadow: 0 2px 10px rgba(0,0,0,0.3);
          }
           #orderSuccessMessage {
                background-color: var(--success-color); /* Default green for success */
                border: 1px solid darkgreen;
                color: #111; /* Dark text on light background */
           }
           #orderSuccessMessage h3, #orderSuccessMessage p {
               color: #111; /* Ensure text inside is dark */
           }

           #upiPaymentInstructions {
               background-color: var(--card-bg);
               border: 1px solid var(--border-color); /* Transparent Teal border */
               color: var(--text-main);
           }
           #upiPaymentInstructions p, #upiPaymentInstructions span {
                color: var(--text-secondary);
           }
           #upiPaymentInstructions .text-primary-accent {
               color: var(--primary-accent); /* Teal */
           }
            #upiPaymentInstructions .text-secondary-accent {
                color: var(--secondary-accent); /* Pink */
                font-weight: 600;
            }


    </style>
</head>
<body class="flex flex-col min-h-screen">

    <div id="termsModal" class="fixed inset-0 z-[80] modal-backdrop flex items-center justify-center hidden p-4">
        <div class="modal-content relative w-full mx-auto animate__animated animate__zoomIn animate__faster overflow-hidden">
             <button type="button" onclick="exitWebsite()" class="modal-close-btn" aria-label="Exit website">&times;</button>

             <div class="text-center">
                <h3 class="text-2xl font-bold mb-4">Terms & Conditions</h3>
                <p class="text-gray-300 mb-6">
                    By tapping on the "Enter" button, you confirm that you have read and agree to our
                    <a href="#" id="viewTermsLink" class="text-primary-accent hover:text-secondary-accent underline">Terms and Conditions</a>. </p>
                <button type="button" id="acceptTermsBtn" class="btn btn-primary">Enter</button>
             </div>
        </div>
    </div>

     <section id="termsAndConditionsFull" class="hidden">
        <div class="full-terms-container">
            <h2 class="text-4xl font-bold">Terms and Conditions</h2>
            <p class="text-sm text-gray-500 text-center mt-2">Effective Date: May 4, 2025</p>

            <p>Welcome to The Highon's Website (the "Website"). This Website is an experimental and educational project created and operated by two individuals aged 15-16.</p>

            <p>Please read these Terms and Conditions ("Terms") carefully before using our Website. By accessing or using the Website, you acknowledge that you have read, understood, and agree to be bound by these Terms. If you do not agree to these Terms, you may not access or use the Website.</p>

            <p class="text-gray-400 italic">Important Note: This Website is intended for educational and experimental purposes only. It is not a commercial enterprise, and its content and functionality, including any items offered for order, are provided without formal legal protections, warranties, or guarantees. Operations are limited to local delivery within Navsari (PIN: 396445).</p>

            <h3>1. Acceptance of Terms</h3>
            <p>By accessing or using our Website, you agree to comply with and be bound by these Terms. If you do not agree to these Terms, please do not use our Website.</p>

            <h3>2. About the Website and Operators</h3>
            <p>This Website is a non-commercial project developed for learning and experimental purposes by two individuals who are currently 15-16 years old. A significant portion of the Website's content and code has been generated with the assistance of artificial intelligence.</p>

            <h3>3. Changes to Terms</h3>
            <p>We reserve the right to modify or replace these Terms at any time. We will indicate at the top of the Terms the date on which they were last updated. Your continued use of the Website after any such changes constitutes your acceptance of the new Terms.</p>

            <h3>4. Access and Use of the Website</h3>
            <p>You may use the Website for lawful purposes only and in accordance with these Terms. You agree not to use the Website:</p>
            <ul>
                 <li>In any way that violates any applicable national, state, local, or international law or regulation.</li>
                 <li>To engage in any conduct that restricts or inhibits anyone's use or enjoyment of the Website.</li>
                 <li>To transmit, or procure the sending of, any unsolicited advertising or promotional material.</li>
                 <li>To impersonate or attempt to impersonate the Website operators or any other person or entity.</li>
            </ul>

            <h3>5. Content and Intellectual Property</h3>
            <p>The content on this Website, including text, graphics, images, and other materials, is provided for informational and experimental purposes only.</p>
             <p class="text-gray-400 italic">Disclaimer Regarding Intellectual Property: Please be advised that no licenses (including copyright or trademark licenses) have been purchased or formally obtained for the content used on this Website. While efforts are made to respect existing rights, the legal status of much of the content in terms of copyright and usage permissions has not been formally verified or licensed. You should assume that content on this site is not licensed for your reuse.</p>
            <p>A significant portion of the content and underlying code of this Website has been generated with the assistance of artificial intelligence. We do not guarantee the accuracy, completeness, or originality of AI-generated content.</p>
            <p>You may view and use the content for your personal, non-commercial use related to the experimental nature of this Website. You must not reproduce, distribute, modify, create derivative works of, publicly display, publicly perform, republish, download, store, or transmit any of the material on our Website for commercial purposes or without acknowledging the experimental nature and the intellectual property disclaimer mentioned herein.</p>

            <h3>6. Product Orders (Experimental)</h3>
            <p>This Website allows users within Navsari (PIN: 396445) to place experimental orders for items listed on the Website. Please note that all items are offered on an "as is" basis. The descriptions are for identification purposes only.</p>
             <p class="text-gray-400 italic">Disclaimer of Product Warranties: We provide no guarantees, warranties, or representations, express or implied, regarding the quality, fitness for a particular purpose, or any other characteristic of the items available for order on this Website. All sales are final unless otherwise explicitly stated at the time of order confirmation (which is handled offline after submission).</p>
            <p>The ordering functionality is part of the experiment, and fulfillment is subject to availability and the discretion of the operators.</p>

            <h3>7. Prohibited Activities</h3>
            <p>When using the Website, you agree not to:</p>
             <ul>
                 <li>Violate any applicable local, state, national, or international law or regulation.</li>
                 <li>Infringe upon the rights of others, including their intellectual property rights.</li>
                 <li>Transmit any malware, viruses, or other harmful computer code.</li>
                 <li>Engage in spamming, phishing, or other fraudulent activities.</li>
                 <li>Attempt to gain unauthorized access to the Website or its systems.</li>
                 <li>Harass, abuse, or harm other users.</li>
                 <li>Use the Website for any commercial purposes without our express written consent (outside of placing experimental orders as permitted herein).</li>
            </ul>

            <h3>8. Third-Party Links</h3>
            <p>The Website may contain links to third-party websites or services that are not owned or controlled by the Website operators. We have no control over, and assume no responsibility for, the content, privacy policies, or practices of any third-party websites or services. You access these at your own risk.</p>

            <h3>9. Disclaimer of Website Warranties</h3>
            <p>THIS WEBSITE IS PROVIDED FOR EDUCATIONAL AND EXPERIMENTAL PURPOSES ONLY, "AS IS" AND "AS AVAILABLE," WITHOUT ANY WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. THIS INCLUDES BUT IS NOT LIMITED TO WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT, ACCURACY, RELIABILITY, OR COMPLETENESS OF THE WEBSITE CONTENT OR FUNCTIONALITY.</P>
            <p>WE DO NOT WARRANT THAT THE WEBSITE WILL BE UNINTERRUPTED, SECURE, OR ERROR-FREE, OR THAT ANY DEFECTS WILL BE CORRECTED. YOU USE THE WEBSITE AT YOUR OWN SOLE RISK.</P>

            <h3>10. Limitation of Liability</h3>
             <p>GIVEN THE EXPERIMENTAL AND NON-COMMERCIAL NATURE OF THIS WEBSITE AND THE AGE OF THE OPERATORS, IN NO EVENT SHALL THE WEBSITE OPERATORS, OR ANYONE ASSOCIATED WITH THEM, BE LIABLE FOR ANY DAMAGES OF ANY KIND, UNDER ANY LEGAL THEORY, ARISING OUT OF or IN CONNECTION WITH YOUR USE, OR INABILITY TO USE, THE WEBSITE, ANY WEBSITES LINKED TO IT, ANY CONTENT ON THE WEBSITE, OR ANY ITEMS ORDERED THROUGH THE WEBSITE. THIS INCLUDES ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING BUT NOT LIMITED TO, PERSONAL INJURY, PAIN AND SUFFERING, EMOTIONAL DISTRESS, LOSS OF REVENUE, LOSS OF PROFITS, LOSS OF BUSINESS OR ANTICIPATED SAVINGS, LOSS OF USE, LOSS OF GOODWILL, LOSS OF DATA, AND WHETHER CAUSED BY TORT (INCLUDING NEGLIGENCE), BREACH OF CONTRACT, OR OTHERWISE, EVEN IF FORESEEABLE.</P>

            <h3>11. Indemnification</h3>
             <p>You agree to defend, indemnify, and hold harmless the Website operators, and anyone associated with them, from and against any claims, liabilities, damages, judgments, awards, losses, costs, expenses, or fees (including reasonable attorneys' fees) arising out of or relating to your violation of these Terms or your use of the Website or items obtained through the Website.</p>

            <h3>12. Governing Law</h3>
             <p>While this is an experimental project, your use of the Website may be subject to applicable laws in India, particularly within Navsari, Gujarat. These Terms shall be governed by and construed in accordance with the laws applicable in Navsari, Gujarat, India. However, due to the experimental nature and the age of the operators, formal legal disputes are not anticipated or supported through this platform.</p>

            <h3>13. Termination</h3>
            <p>We may terminate or suspend your access to the Website at any time, without prior notice or liability, for any reason whatsoever, including without limitation if you breach these Terms.</p>

            <h3>14. Severability</h3>
            <p>If any provision of these Terms is held by a court or other tribunal of competent jurisdiction to be invalid, illegal, or unenforceable for any reason, such provision shall be eliminated or limited to the minimum extent such that the remaining provisions of the Terms will continue in full force and effect.</p>

            <h3>15. Entire Agreement</h3>
            <p>These Terms constitute the sole and entire agreement between you and the Website operators regarding the Website.</p>

            <h3>16. Contact Information</h3>
            <p>To ask questions or comment about these Terms and Conditions, please contact us at:</p>
             <p><a href="mailto:thehighonsofficial@gmail.com">thehighonsofficial@gmail.com</a></p>
             <p class="text-sm text-gray-500 mt-4">Please note that these Terms and Conditions were drafted with the assistance of artificial intelligence based on the information you provided about your experimental website. For any queries regarding these terms, please contact us at the email address above.</p>

             <div class="text-center">
                  <button type="button" id="backToSiteBtn" class="btn btn-secondary btn-back">Back to Site</button>
             </div>

        </div>
    </section>


    <header class="sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex items-center justify-between p-4">
            <div class="flex items-center">
                <a href="#" class="text-2xl tracking-wide brand-name">THE HIGHON'S</a>
            </div>
            <nav class="hidden md:flex items-center space-x-6 lg:space-x-8">
                <a href="#products" class="nav-link">Products</a>
                <a href="#order" class="nav-link">Place Order</a>
                <a href="#request" class="nav-link">Request Product</a>
                <a href="#contact" class="nav-link">Contact</a>
            </nav>
            <div class="md:hidden flex items-center">
                <button onclick="toggleMobileMenu()" class="text-gray-300 hover:text-white focus:outline-none" aria-label="Toggle mobile menu">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        <div id="mobileMenu" class="hidden md:hidden bg-[rgba(17,17,17,0.95)] backdrop-blur-sm border-t border-[rgba(255,255,255,0.1)] p-4 absolute w-full shadow-lg">
            <div class="flex flex-col items-center space-y-4">
                <a href="#products" class="nav-link block py-2" onclick="toggleMobileMenu()">Products</a>
                <a href="#order" class="nav-link block py-2" onclick="toggleMobileMenu()">Place Order</a>
                <a href="#request" class="nav-link block py-2" onclick="toggleMobileMenu()">Request Product</a>
                <a href="#contact" class="nav-link block py-2" onclick="toggleMobileMenu()">Contact</a>
            </div>
        </div>
    </header>

    <section class="hero-section text-center pt-28 pb-20 md:pt-36 md:pb-28 relative">
        <div class="hero-shapes absolute inset-0 z-0">
            <div></div> <div></div> <div></div>
        </div>

        <div class="max-w-4xl mx-auto px-6 relative z-10">
             <img src="GridArt_20250428_230202733.png" alt="The Highon's Logo" class="w-56 sm:w-72 md:w-80 mx-auto mb-8 animate__animated animate__fadeInDown" loading="lazy">

            <h1 class="text-4xl md:text-6xl font-bold mb-6 animate__animated animate__fadeInUp">
                Ignite Your <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary-accent to-secondary-accent">Creativity</span>. </h1> <p class="text-lg md:text-xl mb-10 text-gray-300 max-w-2xl mx-auto animate__animated animate__fadeInUp animate__delay-1s">
                Discover premium supplies in Navsari. Explore keychains, art materials, stationery, and more.
            </p>
            <a href="#products" class="btn btn-primary text-lg px-10 py-4 animate__animated animate__fadeInUp animate__delay-2s">
                Explore Collection
            </a>
        </div>
         </section>

    <section id="products" class="py-20 px-6">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold mb-12 text-center reveal">Our Collection</h2>
            <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-6 reveal"> <div class="relative w-full md:w-2/5 lg:w-1/3">
                    <input type="text" id="productSearch" placeholder="Search products..." class="w-full" aria-label="Search products">
                    <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 search-icon"></i>
                </div>
                <div class="filter-selector text-center md:text-right w-full md:w-auto">
                    <label for="categoryFilter" class="mr-2 font-semibold text-gray-400">Filter:</label>
                    <select id="categoryFilter" class="" aria-label="Select product category">
                        <option value="all">All Products</option>
                        <option value="keychains">Keychains</option>
                        <option value="artSupplies">Art Supplies</option>
                        <option value="stationery">Stationery</option>
                        <option value="diaries">Diaries</option>
                        <option value="gadgets">Gadgets</option>
                    </select>
                </div>
            </div>
            <div id="productsContainer" class="relative min-h-[300px]">
                 <div class="loader"></div>
            </div>
        </div>
    </section>

     <section id="order" class="py-20 px-6 form-section">
        <div class="max-w-3xl mx-auto text-center reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Place Your Order</h2>
            <div id="orderFormContainer" class="text-left">
                <p class="text-gray-400 mb-6">Items added from the 'Our Collection' section will appear below. Fill in your details to place your order for delivery within Navsari (PIN: 396445).</p>

                <div>
                     <label class="mb-2 block text-secondary">Your Order Summary</label>
                     <div id="orderSummaryDisplay">
                         <p>Add items from the collection above to see your order here.</p>
                     </div>
                </div>

                 <div class="mt-6 mb-4">
                     <label for="couponCode" class="mb-2 block text-secondary">Have a Coupon Code?</label>
                     <input type="text" id="couponCode" placeholder="Enter coupon code (optional)" aria-label="Enter coupon code">
                      <p id="couponFeedback" class="text-sm mt-2 text-gray-400 min-h-[1.2em]"></p> </div>


                <form id="orderForm" action="https://formsubmit.co/thehighonsofficial@gmail.com" method="POST" class="space-y-6 text-left">
                     <input type="hidden" name="_next" value="YOUR_THANK_YOU_URL/thank-you-order.html">
                     <input type="hidden" name="_captcha" value="false">
                     <input type="hidden" name="_subject" id="formSubject" value="New Order from The Highon's Site!">
                     <input type="hidden" name="Order Summary" id="hiddenOrderSummary" value="">
                      <div>
                        <label for="orderNotes">Additional Notes (Optional)</label>
                         <textarea id="orderNotes" name="Additional Notes" rows="3" placeholder="Any specific instructions or details?" aria-label="Additional notes for order"></textarea>
                    </div>

                    <div>
                        <label for="orderName">Full Name</label>
                        <input type="text" id="orderName" name="name" placeholder="Enter your full name" required aria-label="Full Name for order">
                    </div>
                    <div>
                        <label for="orderEmail">Email</label>
                        <input type="email" id="orderEmail" name="email" placeholder="Enter your email" required aria-label="Email Address for order">
                    </div>
                     <div>
                        <label for="orderPhone">Phone (+91)</label>
                         <input type="tel" id="orderPhone" name="phone" placeholder="Enter 10-digit number" required pattern="[6-9]\d{9}" title="Please enter a valid 10-digit Indian mobile number (starting with 6, 7, 8, or 9)" aria-label="Phone number for order (starts with 6-9, 10 digits)">
                    </div>
                    <div>
                        <label for="orderAddress">Full Address (Navsari)</label>
                        <input type="text" id="orderAddress" name="address" placeholder="House No, Street, Area, Navsari - 396445" required aria-label="Full Address for order">
                    </div>

                    <button type="button" id="forgetMyDetailsBtn" class="text-sm text-gray-500 hover:text-red-400 focus:outline-none transition-colors duration-200 mt-2 hidden" aria-label="Forget my saved details">
                        Forget My Details
                    </button>


                    <div>
                        <label for="orderPayment">Payment Option</label>
                        <select id="orderPayment" name="payment" class="w-full" aria-label="Payment option">
                            <option value="COD">Cash on Delivery</option>
                            <option value="UPI">UPI Payment</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary w-full" id="placeOrderBtn">Place Order</button>
                </form>

                 <div id="upiPaymentInstructions" class="hidden mt-6 p-6 bg-card-bg border border-border-color rounded-md text-center">
                    <h4 class="text-xl font-bold mb-4 text-primary-accent">Complete Your UPI Payment</h4>
                     <p class="text-gray-300 mb-4">Your order has been recorded. Please complete the payment using the details below.</p>

                    <div class="space-y-3 mb-6">
                         <p><span class="font-semibold text-gray-400">UPI ID (VPA):</span> <span class="text-secondary-accent break-all">9328337760@fam</span></p>
                         <img src="IMG_20250505_125804_715.jpg" alt="Your UPI QR Code" class="mx-auto w-48 h-48 object-contain border border-gray-700 p-2 rounded" loading="lazy">
                    </div>

                     <p class="text-sm text-gray-400 italic">
                         <i class="fas fa-info-circle mr-1"></i> Your order is pending until we manually verify the payment in our account. Please allow some time for confirmation.
                     </p>
                     <p class="text-sm text-gray-400 italic mt-2">
                          For faster processing, you can mention your Name or Order date in the payment reference, or email us a screenshot of the payment.
                     </p>
                     <p class="text-sm text-gray-400 italic mt-2">
                          You will receive confirmation via email/phone once payment is verified and your order is ready for processing.
                     </p>
                </div>

                 <div id="orderSuccessMessage" class="hidden mt-6 p-6 bg-green-800 text-white border border-green-600 rounded-md text-center">
                    <h3 class="text-2xl font-bold mb-3">Order Received Successfully!</h3>
                    <p id="submissionStatusMessage" class="text-lg"></p>
                     <p class="text-sm mt-4">Thank you for your order!</p>
                </div>


            </div>
        </div>
    </section>


    <section id="request" class="py-20 px-6 form-section">
        <div class="max-w-2xl mx-auto text-center reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Request a Product</h2>
            <p class="text-gray-400 mb-8 max-w-xl mx-auto">Can't find what you're looking for? Let us know, and we'll try our best to source it for you!</p>
            <div class="form-container">
                <form id="requestForm" action="https://formsubmit.co/thehighonsofficial@gmail.com" method="POST" class="space-y-6 text-left">
                    <input type="hidden" name="_next" value="YOUR_THANK_YOU_URL/thank-you-request.html">
                    <input type="hidden" name="_subject" value="New Product Request from The Highon's Site">
                    <input type="hidden" name="_captcha" value="false">
                    <div>
                        <label for="requestName">Product Name</label>
                        <input type="text" id="requestName" name="product" placeholder="e.g., Specific brand watercolor set" required aria-label="Product name for request">
                    </div>
                    <div>
                        <label for="requestDetails">Additional Details (Optional)</label>
                        <textarea id="requestDetails" name="details" rows="4" placeholder="Brand, color, size, quantity, etc." aria-label="Additional details for product request"></textarea>
                    </div>
                    <div>
                        <label for="requestEmail">Your Email</label>
                        <input type="email" id="requestEmail" name="email" placeholder="your.email@example.com" required aria-label="Your email address for request">
                    </div>
                    <button type="submit" class="btn btn-primary w-full mt-4">Submit Request</button>
                </form>
            </div>
        </div>
    </section>

    <section id="contact" class="py-20 text-center px-6">
        <div class="max-w-4xl mx-auto reveal">
            <h2 class="text-4xl md:text-5xl font-bold mb-8">Get In Touch</h2>
            <div class="grid grid-cols-1 gap-8 text-left">
                <div class="contact-info-box">
                    <h3 class="text-2xl font-semibold mb-6 text-center">Contact Information</h3>
                    <div class="space-y-4 text-center text-lg">
                        <p><span class="font-medium text-gray-400">Email:</span> <a href="mailto:thehighonsofficial@gmail.com">thehighonsofficial@gmail.com</a></p>
                        <p><span class="font-medium text-gray-400">Location:</span> Navsari, Gujarat - 396445</p>
                         <p class="text-sm text-gray-500">(Online orders via this site for local delivery only)</p>
                    </div>
                    <div class="flex justify-center space-x-6 mt-8 social-icons">
                        <a href="https://instagram.com/thehighons" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="py-10 mt-auto">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left gap-6">
                <div>
                    <span class="text-2xl font-bold tracking-wide brand-name">THE HIGHON'S</span>
                    <p class="mt-1 text-sm text-gray-400">Premium Creative Supplies - Navsari</p>
                </div>
                <div class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-sm">
                    <a href="#products">Products</a>
                    <a href="#order">Place Order</a>
                    <a href="#request">Request</a>
                    <a href="#contact">Contact</a>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500 text-xs">
                <p> <span id="footerYear"></span> The Highon's.</p>
            </div>
        </div>
    </footer>

    <div id="productModal" class="fixed inset-0 z-[70] modal-backdrop flex items-center justify-center hidden p-4">
        <div class="modal-content relative max-w-lg w-full mx-auto animate__animated animate__zoomIn animate__faster overflow-hidden">
             <button onclick="closeModal()" class="modal-close-btn" aria-label="Close product details modal">&times;</button>
             <div class="p-6 sm:p-8 max-h-[80vh] overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <img id="modalImg" src="" alt="" class="w-full h-64 md:h-full object-contain p-2" loading="lazy">
                    <div class="flex flex-col justify-center">
                        <h3 id="modalName" class="text-2xl lg:text-3xl font-bold mb-3"></h3>
                        <p id="modalDesc" class="text-sm lg:text-base mb-5"></p>
                        <div id="modalPriceInfo" class="modal-price-info">
                             </div>
                        <p class="text-sm text-gray-400">To order this item, please go to the <a href="#products" onclick="closeModal()" class="text-primary-accent hover:text-secondary-accent underline">Our Collection section</a> and click 'Add' on the product card.</p> </div>
                </div>
             </div>
        </div>
    </div>

    <script>
        // --- Constants ---
        const USER_DETAILS_STORAGE_KEY = 'highonsUserDetails';
        const CART_STORAGE_KEY = 'highonsCartItems';
        const TERMS_ACCEPTED_STORAGE_KEY = 'highonsTermsAccepted'; // New key for T&C

        // --- Product Data ---
        const products = {
             keychains: [
                { id: "kc001", name: "Thor Loki Keychain", originalPrice: 217, price: 99, img: "Screenshot_20250422_132243_Meesho.jpg", desc: "High-quality metal keychain featuring Thor and Loki designs" },
                { id: "kc002", name: "Thor Hammer Keychain", originalPrice: 130, price: 89, img: "Screenshot_20250422_131740_Meesho.jpg", desc: "Durable Mjolnir keychain with detailed engraving" },
                { id: "kc003", name: "Demon slayer katana keychain", originalPrice: 200, price: 159, img: "Screenshot_20250424_141150_Meesho.jpg", desc: "Miniature katana keychain from Demon Slayer anime" },
                { id: "kc004", name: "Pikachu Keychain", originalPrice: 200, price: 109, img: "Screenshot_20250422_131948_Meesho.jpg", desc: "Cute Pikachu keychain with enamel finish" }
            ],
            artSupplies: [
                { id: "as001", name: "Camel water colour tube", originalPrice: 200, price: 169, img: "Screenshot_20250424_134214_Meesho.jpg", desc: "Professional-grade watercolor tubes, set of 12 vibrant colors" },
                { id: "as002", name: "FLAIR Acrylic marker", originalPrice: 380, price: 359, img: "Screenshot_20250423_144509_Meesho.jpg", desc: "Premium acrylic paint markers, fine tip for detailed work" },
                { id: "as003", name: "Levin Acrylic Markers", originalPrice: 700, price: 409, img: "Screenshot_20250423_140558_Meesho.jpg", desc: "Dual-tip acrylic markers with broad and fine tips" },
                { id: "as004", name: "Marker Set of 48", originalPrice: 430, price: 299, img: "Touch-48-Color-Marker-Pen-Set-Kids-Art-Essentials-Double-Ended-Vibrant-Colors-Non-Bleeding-Wholesale-Discount-.webp", desc: "48-color marker set with dual tips for versatility" },
                { id: "as005", name: "Markers Set of 24", originalPrice: 250, price: 179, img: "81B5uZXhYEL._AC_UF1000,1000_QL80_.jpg", desc: "24-color marker set, perfect for beginners" },
                { id: "as006", name: "Paint Brush 12 sizes", originalPrice: 250, price: 99, img: "Screenshot_20250423_195924_Meesho.jpg", desc: "Professional paint brush set with 12 different sizes" },
                { id: "as007", name: "Sponge Dabbing Brush 5 Piece Set", originalPrice: 160, price: 99, img: "41fvlzAzMWL._AC_.jpg", desc: "Sponge brush set for texture painting and special effects" },
                { id: "as008", name: "artist gesso + Decor varnish combo", originalPrice: 400, price: 259, img: "camel-combo.jpg", desc: "Premium gesso (100ml) and varnish combo for art projects" }
            ],
            stationery: [
                { id: "st001", name: "Correction Tape", originalPrice: 75, price: 70, img: "51l7S8XUY0L.jpg", desc: "Smooth correction tape for error-free writing" },
                { id: "st002", name: "Hot Melt Glue Gun ", originalPrice: 300, price: 220, img: "71xHhYjWcIL.jpg", desc: "glue gun for more effective bond for crafts" },
                { id: "st003", name: "Sketch Kit", originalPrice: 1000, price: 619, img: "Screenshot_20250423_205027_Meesho.jpg", desc: "Complete sketching kit with pencils, erasers and sharpeners" },
                { id: "st004", name: "Luxury Pen", originalPrice: 220, price: 199, img: "Screenshot_20250422_001401.jpg", desc: "Premium metal body pen with smooth ink flow" },
                { id: "st005", name: "Sketch book A5 (100pg)", originalPrice: 150, price: 119, img: "Screenshot_20250423_204415_Meesho.jpg", desc: "A5 size sketchbook with 100gsm paper, 100 pages" }
            ],
            diaries: [
                { id: "di001", name: "Hardcover Diary", originalPrice: 400, price: 249, img: "81EROqfMQBL._AC_UF1000,1000_QL80_.jpg", desc: "Classic hardcover diary with premium paper" },
                { id: "di002", name: "Premium  Diary", originalPrice: 400, price: 319, img: "IMG-20250422-WA0005.jpg", desc: "Premium leather-bound diary" },
                { id: "di003", name: "Mini Diary", originalPrice: 300, price: 219, img: "Screenshot_20250422_215326_Meesho.jpg", desc: "diary with compact size" },
                { id: "di004", name: "Vintage Leather Journal", originalPrice: 800, price: 499, img: "Screenshot_20250426_225225_Amazon.jpg", desc: "Premium leather diary with good quality paper" }
            ],
            gadgets: [
                 { id: "ga001", name: "Mini Thermal Printer", originalPrice: 1200, price: 899, img: "placeholder-gadget.png", desc: "Compact thermal printer for labels, notes & fun prints. Bluetooth connectivity." }
            ]
        };


         // --- Coupon Data (Code: { type: 'percentage_discount' | 'fixed_discount' | 'percentage_increase', value: number }) ---
         const coupons = {
             "JIANSPECIAL": { type: "percentage_increase", value: 20 }, // 20% increase
             "NSL10": { type: "percentage_discount", value: 10 } // 10% discount
         };


        // --- State Variables ---
        let currentModalProduct = null; // { category: string, index: number, id: string }
        let currentCategoryFilter = 'all';
        let orderItems = {}; // Stores product ID and quantity: { "productId": quantity, ... }
        let siteLoaded = false; // Flag to track if the main site content has been loaded


        // --- Utility Functions ---
        function escapeHtml(unsafe) {
            if (typeof unsafe !== 'string') return unsafe;
            return unsafe
                 .replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;")
                 .replace(/'/g, "&#039;");
        }

        function findProduct(id) {
            for (const categoryKey in products) {
                const product = products[categoryKey].find(p => p.id === id);
                if (product) {
                    // Return product details along with its category
                    return { ...product, category: categoryKey };
                }
            }
            return null; // Product not found
        }

         function saveCart() {
             try {
                 localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(orderItems));
                 console.log("Cart saved:", orderItems);
             } catch (e) {
                 console.error("Error saving cart to localStorage:", e);
             }
         }

         function loadCart() {
             try {
                 const savedCart = localStorage.getItem(CART_STORAGE_KEY);
                 if (savedCart) {
                     const parsedCart = JSON.parse(savedCart);
                     // Basic validation: Ensure it's an object and quantities are numbers > 0
                     if (typeof parsedCart === 'object' && parsedCart !== null) {
                          orderItems = Object.fromEntries(
                              Object.entries(parsedCart)
                                  .filter(([productId, quantity]) => findProduct(productId) && typeof quantity === 'number' && quantity > 0)
                          );
                         console.log("Cart loaded:", orderItems);
                     } else {
                          orderItems = {}; // Start with an empty cart if invalid data is found
                         console.warn("Invalid cart data found in localStorage, starting with empty cart.");
                     }
                 } else {
                     orderItems = {}; // Start with empty cart if nothing is in storage
                     console.log("No cart data found in localStorage, starting with empty cart.");
                 }
             } catch (e) {
                 console.error("Error loading cart from localStorage:", e);
                 orderItems = {}; // Start with empty cart on error
             }
         }

        // Function to manage body overflow based on visible modals/full terms
        function updateBodyOverflow() {
             const productModal = document.getElementById('productModal');
             const termsModal = document.getElementById('termsModal');
             const termsFull = document.getElementById('termsAndConditionsFull');

             if (!(productModal?.classList.contains('hidden')) || !(termsModal?.classList.contains('hidden')) || !(termsFull?.classList.contains('hidden'))) {
                 document.body.classList.add('overflow-hidden');
             } else {
                 document.body.classList.remove('overflow-hidden');
             }
        }

         // Calculate discount percentage
         function calculateDiscountPercentage(originalPrice, discountedPrice) {
             if (originalPrice > discountedPrice && originalPrice > 0) {
                 return Math.round(((originalPrice - discountedPrice) / originalPrice) * 100);
             }
             return 0; // No discount or invalid prices
         }


        // --- Product Rendering (Adapted for new styling) ---
        function renderProducts(category = 'all', searchTerm = '') {
            const container = document.getElementById("productsContainer");
            if (!container) { console.error("productsContainer not found!"); return; }

            container.innerHTML = '<div class="loader"></div>'; // Show loader

            // Use a small delay to allow loader to show and avoid blocking
            setTimeout(() => {
                 try {
                    container.innerHTML = ''; // Clear loader/previous content
                    let hasProducts = false;
                    const searchTermLower = searchTerm.toLowerCase().trim();
                    currentCategoryFilter = category;

                    const createCategorySection = (catKey, items) => {
                        const filtered = items.filter(item =>
                            !searchTermLower ||
                            item.name.toLowerCase().includes(searchTermLower) ||
                            item.desc.toLowerCase().includes(searchTermLower)
                        );

                        if (filtered.length > 0) {
                            hasProducts = true;
                            const section = document.createElement('div');
                            section.className = 'mb-16';
                            const title = catKey.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                            if (category === 'all' || category === catKey) {
                                section.innerHTML = `<h3 class="category-title reveal">${escapeHtml(title)}</h3>`;
                            }

                            const grid = document.createElement('div');
                            // Updated grid classes for more columns on larger screens and adjusted gaps
                            grid.className = 'grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-8';
                            grid.id = `${catKey}Grid`;
                            section.appendChild(grid);
                            container.appendChild(section);

                            filtered.forEach((product, index) => { // Pass index here
                                const card = createProductCard(product, index); // Pass index to card creation
                                grid.appendChild(card);
                                observeElement(card); // Add to observer for reveal animation
                            });
                            // Observe title only if it's explicitly created for this category section
                            const categoryTitle = section.querySelector('.category-title');
                             if (categoryTitle) {
                                 observeElement(categoryTitle);
                             }
                        }
                    };

                    if (category === 'all') {
                        Object.entries(products).forEach(([catKey, items]) => {
                            createCategorySection(catKey, items);
                        });
                    } else if (products[category]) {
                        createCategorySection(category, products[category]);
                    }

                    if (!hasProducts) {
                        container.innerHTML = '<p class="text-center text-gray-400 py-12 text-lg">No products found matching your criteria.</p>';
                    }

                 } catch (error) {
                    console.error("Error rendering products:", error);
                    container.innerHTML = '<p class="text-center text-red-500 py-12 text-lg">Error loading products. Please try again later.</p>';
                }
            }, 50); // Small timeout
        }


        function createProductCard(product, index) { // Accept index
            const card = document.createElement("div");
            card.id = `product-${product.id}`; // Add ID for easy lookup
            card.className = "product-card reveal"; // Add reveal class
            card.setAttribute('data-product-id', product.id); // Use product.id
             card.setAttribute('data-index', index); // Add data-index

            const productNameSafe = escapeHtml(product.name);
            const productDescSafe = escapeHtml(product.desc);
            const productImgSafe = escapeHtml(product.img);

            const quantity = orderItems[product.id] || 0; // Get current quantity from state

             const hasDiscount = product.originalPrice && product.originalPrice > product.price;
             const discountPercentage = hasDiscount ? calculateDiscountPercentage(product.originalPrice, product.price) : 0;

             const priceDisplay = hasDiscount ?
                `<span class="original-price">${product.originalPrice}</span>
                 <span class="discounted-price">${product.price}</span>
                 <span class="discount-percentage">${discountPercentage}% OFF</span>` :
                `<span class="discounted-price">${product.price}</span>`; // Use discounted-price class even if no discount for consistent styling


            card.innerHTML = `
                <div class="product-image-wrapper"> <img src="${productImgSafe}" alt="${productNameSafe}" loading="lazy" class="product-img">
                </div>
                <div class="product-card-content"> <div>
                        <h3 title="${productNameSafe}">${productNameSafe}</h3>
                        <p class="product-desc" title="${productDescSafe}">${productDescSafe ? productDescSafe.substring(0, 80) + (productDescSafe.length > 80 ? '...' : '') : ''}</p>
                        <div class="product-price-info">${priceDisplay}</div>
                    </div>
                </div>
                <div class="product-card-controls mt-auto">
                    ${quantity === 0
                        ? `<button type="button" class="btn btn-primary btn-add w-full" data-product-id="${product.id}">Add</button>`
                        : `
                            <div class="product-quantity-controls" data-product-id="${product.id}">
                                <button type="button" class="btn btn-secondary btn-small btn-decrease" data-product-id="${product.id}" aria-label="Decrease quantity">-</button>
                                <span class="product-quantity">${quantity}</span>
                                <button type="button" class="btn btn-secondary btn-small btn-increase" data-product-id="${product.id}" aria-label="Increase quantity">+</button>
                            </div>
                        `
                    }
                </div>
            `;
             // Add click listener directly to the card for modal
             card.addEventListener('click', (event) => {
                 // Check if the click target is NOT one of the quantity control buttons or the card control area itself
                 const target = event.target;
                 if (!target.closest('.product-card-controls') && !target.classList.contains('btn-add')) {
                      showModal(product.id); // Uses product.id here, which is correct
                 }
             });

            return card;
        }

        // --- Order Management Functions ---
        function addItemToOrder(productId) {
            const product = findProduct(productId);
            if (!product) {
                console.error("Attempted to add non-existent product:", productId);
                return;
            }

            if (orderItems[productId]) {
                increaseQuantity(productId);
            } else {
                orderItems[productId] = 1;
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            }
             console.log('Order Items:', orderItems);
        }

        function increaseQuantity(productId) {
            const product = findProduct(productId);
             if (!product) {
                 console.error("Attempted to increase quantity for non-existent product:", productId);
                 return;
             }
            if (orderItems[productId] !== undefined) {
                orderItems[productId]++;
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            } else {
                 // This case shouldn't happen if UI is in sync with state, but handle defensively
                 addItemToOrder(productId);
            }
             console.log('Order Items:', orderItems);
        }

        function decreaseQuantity(productId) {
             const product = findProduct(productId);
             if (!product) {
                 console.error("Attempted to decrease quantity for non-existent product:", productId);
                 return;
             }
            if (orderItems[productId] !== undefined) {
                orderItems[productId]--;
                if (orderItems[productId] <= 0) {
                    delete orderItems[productId];
                }
                 saveCart();
                 updateProductCardUI(productId);
                 renderOrderSummary();
            }
             console.log('Order Items:', orderItems);
        }

        function updateProductCardUI(productId) {
            const card = document.getElementById(`product-${productId}`);
            if (!card) {
                 console.warn(`Product card not found for ID: ${productId}. Cannot update UI.`);
                 return;
            }

            const controlsContainer = card.querySelector('.product-card-controls');
            const quantity = orderItems[productId] || 0;

            controlsContainer.innerHTML = ''; // Clear current controls

            if (quantity === 0) {
                controlsContainer.innerHTML = `<button type="button" class="btn btn-primary btn-add w-full" data-product-id="${productId}">Add</button>`;
            } else {
                 controlsContainer.innerHTML = `
                    <div class="product-quantity-controls" data-product-id="${productId}">
                        <button type="button" class="btn btn-secondary btn-small btn-decrease" data-product-id="${productId}" aria-label="Decrease quantity">-</button>
                                <span class="product-quantity">${quantity}</span>
                                <button type="button" class="btn btn-secondary btn-small btn-increase" data-product-id="${productId}" aria-label="Increase quantity">+</button>
                            </div>
                 `;
            }
             // Event listeners for these buttons are handled by delegation on productsContainer
        }


        function renderOrderSummary() {
             const summaryDisplay = document.getElementById('orderSummaryDisplay');
             const hiddenSummaryInput = document.getElementById('hiddenOrderSummary');
             const formSubjectInput = document.getElementById('formSubject');
             const couponCodeInput = document.getElementById('couponCode');
             const couponFeedback = document.getElementById('couponFeedback');
             const placeOrderBtn = document.getElementById('placeOrderBtn');


             if (!summaryDisplay || !hiddenSummaryInput || !formSubjectInput || !couponCodeInput || !couponFeedback || !placeOrderBtn) {
                 console.error("One or more order summary/coupon/button elements not found.");
                 return;
             }

             const productIds = Object.keys(orderItems);
             let subtotal = 0;
             let displayHTML = '';
             let hiddenText = 'Order Summary:\n\n';

             if (productIds.length === 0) {
                 displayHTML = '<p>Add items from the collection above to see your order here.</p>';
                 hiddenText = 'Order is empty.';
                 formSubjectInput.value = 'New Order from The Highon\'s Site (Empty)';
                  couponCodeInput.disabled = true; // Disable coupon input if cart is empty
                  couponCodeInput.value = ''; // Clear coupon input if cart becomes empty
                  couponFeedback.textContent = '';
                  placeOrderBtn.disabled = true; // Disable order button
             } else {
                  couponCodeInput.disabled = false; // Enable coupon input if items are in cart
                  placeOrderBtn.disabled = false; // Enable order button

                 displayHTML += '<ul>';
                 productIds.forEach(productId => {
                     const product = findProduct(productId);
                     const quantity = orderItems[productId];
                     if (product && quantity > 0) {
                         const itemTotal = product.price * quantity;
                         subtotal += itemTotal;
                         displayHTML += `
                            <li>
                                <span class="order-item-name">${escapeHtml(product.name)}</span>
                                <span class="order-item-quantity">x ${quantity}</span>
                                <span class="order-item-price">${itemTotal.toFixed(2)}</span>
                            </li>
                         `;
                          hiddenText += `- ${escapeHtml(product.name)} x ${quantity} (${product.price.toFixed(2)} each = ${itemTotal.toFixed(2)})\n`;
                     }
                 });
                 displayHTML += '</ul>';

                 // Display Subtotal
                 displayHTML += `<div class="order-summary-line"><span>Subtotal:</span> <span>${subtotal.toFixed(2)}</span></div>`;
                 hiddenText += `\nSubtotal: ${subtotal.toFixed(2)}`;


                 // --- Apply Coupon Logic ---
                 let finalTotal = subtotal;
                 let priceAdjustment = 0; // Can be positive (increase) or negative (discount)
                 let feedbackMessage = '';
                 let adjustmentLineHTML = '';
                 let hiddenAdjustmentText = '';
                 let couponApplied = false;

                 const enteredCouponCode = couponCodeInput.value.trim().toUpperCase(); // Case-insensitive

                 if (enteredCouponCode) {
                     const coupon = coupons[enteredCouponCode];
                     if (coupon) {
                          couponApplied = true;
                         if (coupon.type === 'percentage_increase') {
                             priceAdjustment = subtotal * (coupon.value / 100);
                             finalTotal = subtotal + priceAdjustment;
                             feedbackMessage = `Coupon "${enteredCouponCode}" applied: +${coupon.value}% increase.`;
                             adjustmentLineHTML = `<div class="order-summary-line increase-line"><span>Coupon (${enteredCouponCode}):</span> <span>+${priceAdjustment.toFixed(2)}</span></div>`;
                             hiddenAdjustmentText = `\nCoupon Applied: ${enteredCouponCode} (+${coupon.value}% Increase) +${priceAdjustment.toFixed(2)}`;
                              couponFeedback.style.color = 'var(--danger-color)'; // Red for increase
                         } else if (coupon.type === 'percentage_discount') {
                             priceAdjustment = subtotal * (coupon.value / 100);
                             finalTotal = subtotal - priceAdjustment;
                             feedbackMessage = `Coupon "${enteredCouponCode}" applied: ${coupon.value}% off!`;
                             adjustmentLineHTML = `<div class="order-summary-line discount-line"><span>Coupon (${enteredCouponCode}):</span> <span>-${priceAdjustment.toFixed(2)}</span></div>`;
                             hiddenAdjustmentText = `\nCoupon Applied: ${enteredCouponCode} (-${coupon.value}% Discount) -${priceAdjustment.toFixed(2)}`;
                              couponFeedback.style.color = 'var(--success-color)'; // Green for discount
                         }
                         else { // Handle unknown coupon types
                             feedbackMessage = `Coupon "${enteredCouponCode}" has an unknown type.`;
                             couponApplied = false;
                             couponFeedback.style.color = 'var(--text-secondary)';
                         }
                     } else {
                         feedbackMessage = `Invalid coupon code: "${enteredCouponCode}"`;
                          couponFeedback.style.color = 'var(--text-secondary)';
                     }
                 } else {
                     // No coupon code entered or code was cleared
                     feedbackMessage = '';
                      couponFeedback.style.color = 'var(--text-secondary)';
                 }

                 // Ensure total doesn't go below zero
                 finalTotal = Math.max(0, finalTotal);

                 // Append adjustment line if applicable
                 if (adjustmentLineHTML) {
                     displayHTML += adjustmentLineHTML;
                 }
                 couponFeedback.textContent = feedbackMessage;
                 hiddenText += hiddenAdjustmentText;


                 // Display Final Total
                 displayHTML += `<div class="order-total">Final Total: ${finalTotal.toFixed(2)}</div>`;
                 hiddenText += `\nFinal Total: ${finalTotal.toFixed(2)}`;

                 // Update form subject with final total and coupon status
                 formSubjectInput.value = `New Order from The Highon's Site (Final ${finalTotal.toFixed(2)})` + (couponApplied ? ` - Coupon: ${enteredCouponCode}` : '');

             }

             summaryDisplay.innerHTML = displayHTML;
             hiddenSummaryInput.value = hiddenText;
        }

        // --- User Details Management (using localStorage) ---
        function loadUserDetails() {
            const userDetails = localStorage.getItem(USER_DETAILS_STORAGE_KEY);
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');
            const forgetButton = document.getElementById('forgetMyDetailsBtn');

            if (userDetails && nameInput && emailInput && phoneInput && addressInput && forgetButton) {
                try {
                    const parsedDetails = JSON.parse(userDetails);
                    // Populate if data exists and is not empty
                    if (parsedDetails.name || parsedDetails.email || parsedDetails.phone || parsedDetails.address) {
                        nameInput.value = parsedDetails.name || '';
                        emailInput.value = parsedDetails.email || '';
                        phoneInput.value = parsedDetails.phone || '';
                        addressInput.value = parsedDetails.address || '';
                        forgetButton.classList.remove('hidden'); // Show forget button
                    } else {
                         forgetButton.classList.add('hidden'); // Hide if data is empty object
                    }
                } catch (e) {
                    console.error("Error parsing user details from localStorage", e);
                    clearUserDetails(); // Clear invalid data
                }
            } else if (forgetButton) {
                 forgetButton.classList.add('hidden'); // Hide forget button if no data or elements missing
            }
        }

        function saveUserDetails() {
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');

            if (nameInput && emailInput && phoneInput && addressInput) {
                const userDetails = {
                    name: nameInput.value,
                    email: emailInput.value,
                    phone: phoneInput.value,
                    address: addressInput.value
                };
                 // Save only if name and email are provided (basic check)
                 if(userDetails.name && userDetails.email) {
                    try {
                         localStorage.setItem(USER_DETAILS_STORAGE_KEY, JSON.stringify(userDetails));
                         console.log("User details saved.");
                         // Show forget button after saving
                          const forgetButton = document.getElementById('forgetMyDetailsBtn');
                          if(forgetButton) forgetButton.classList.remove('hidden');
                    } catch (e) {
                         console.error("Error saving user details to localStorage:", e);
                    }
                 } else {
                     console.log("User details not saved: Name or Email missing.");
                 }
            }
        }

        function clearUserDetails() {
            localStorage.removeItem(USER_DETAILS_STORAGE_KEY);
            const nameInput = document.getElementById('orderName');
            const emailInput = document.getElementById('orderEmail');
            const phoneInput = document.getElementById('orderPhone');
            const addressInput = document.getElementById('orderAddress');
             const forgetButton = document.getElementById('forgetMyDetailsBtn');


            if (nameInput) nameInput.value = '';
            if (emailInput) emailInput.value = '';
            if (phoneInput) phoneInput.value = '';
            if (addressInput) addressInput.value = '';
            if (forgetButton) forgetButton.classList.add('hidden');

            console.log("User details cleared.");
        }


        // --- UI Interaction Functions ---

        function showModal(productId) {
           try {
                const product = findProduct(productId);
                if (!product) {
                    console.error("Product not found for modal:", productId);
                    return;
                }

                const modalImg = document.getElementById('modalImg');
                const modalName = document.getElementById('modalName');
                const modalDesc = document.getElementById('modalDesc');
                const modalPriceInfo = document.getElementById('modalPriceInfo'); // Target the price info div
                const productModal = document.getElementById('productModal');

                if (!modalImg || !modalName || !modalDesc || !modalPriceInfo || !productModal) {
                     console.error("Product modal elements missing!");
                     return;
                }

                modalImg.src = escapeHtml(product.img);
                modalImg.alt = escapeHtml(product.name);
                modalName.textContent = escapeHtml(product.name);
                modalDesc.textContent = escapeHtml(product.desc);

                // Generate price display for modal
                const hasDiscount = product.originalPrice && product.originalPrice > product.price;
                const discountPercentage = hasDiscount ? calculateDiscountPercentage(product.originalPrice, product.price) : 0;

                modalPriceInfo.innerHTML = hasDiscount ?
                   `<span class="original-price">${product.originalPrice}</span>
                    <span class="discounted-price">${product.price}</span>
                    <span class="discount-percentage">${discountPercentage}% OFF</span>` :
                   `<span class="discounted-price">${product.price}</span>`;


                productModal.classList.remove('hidden');
                updateBodyOverflow(); // Update overflow based on *all* modals

           } catch (error) {
                console.error("Error showing modal:", error);
                closeModal();
           }
        }

        function closeModal() {
          const productModal = document.getElementById('productModal');
          if (productModal) {
            productModal.classList.add('hidden');
          }
           updateBodyOverflow(); // Update overflow based on *all* modals
        }

        function toggleMobileMenu() {
          const mobileMenu = document.getElementById('mobileMenu');
          if (mobileMenu) {
            mobileMenu.classList.toggle('hidden');
          }
        }


        // --- Terms and Conditions Functions ---
        function showTermsModal() {
            const termsModal = document.getElementById('termsModal');
            if (termsModal) {
                termsModal.classList.remove('hidden');
                updateBodyOverflow();
            } else {
                console.error("Terms modal element not found.");
            }
        }

        function hideTermsModal() {
            const termsModal = document.getElementById('termsModal');
            if (termsModal) {
                termsModal.classList.add('hidden');
                updateBodyOverflow();
            }
        }

        function showFullTerms() {
             const termsFull = document.getElementById('termsAndConditionsFull');
             if(termsFull) {
                 termsFull.classList.remove('hidden');
                  updateBodyOverflow();
                  // Optional: Scroll to top of terms page
                  termsFull.scrollTop = 0; // For the section itself
                  window.scrollTo(0, 0); // For overall page scroll
             } else {
                 console.error("Full terms and conditions section not found.");
             }
        }

        function hideFullTerms() {
             const termsFull = document.getElementById('termsAndConditionsFull');
             if(termsFull) {
                 termsFull.classList.add('hidden');
                  updateBodyOverflow();
             }
        }

        function exitWebsite() {
            // Attempt to close the window. Note: This often only works for windows
            // that were opened via script (e.g., window.open()).
            // A more reliable approach for a standard tab is to redirect or show a message.
             // Redirecting to a blank page simulates "exiting" without leaving the user on an error page.
            if (window.opener) { // If this window was opened by another script
                window.close();
            } else { // For a standard tab or window not opened by script
                 // You could show a message or redirect
                 alert("Thank you for visiting! The website will now close or navigate away.");
                 window.location.href = 'about:blank'; // Redirect to a blank page
                 // Alternatively, you could redirect to a simple "Goodbye" page on your site
                 // window.location.href = '/goodbye.html';
            }
        }


        // --- Scroll Animation Observer ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const target = entry.target;
                    const index = target.getAttribute('data-index');
                    // Apply the calculated delay only if data-index exists (for product cards)
                    // or use a small default delay for others.
                    const delay = index !== null ? index * 50 : 50;

                    // Apply the calculated delay
                    target.style.transitionDelay = `${delay}ms`;

                    // Add the visible class to trigger the animation
                    target.classList.add('visible');

                    // Optional: unobserve after revealing to save resources if element won't be hidden again
                     // This is generally good practice for static elements once animated
                    // observer.unobserve(entry.target);
                } else {
                     // Optional: remove visible class and reset delay if you want elements to re-animate on scroll back up
                     // target.classList.remove('visible');
                     // target.style.transitionDelay = '0s'; // Reset delay when not intersecting
                }
            });
        }, {
            threshold: 0.1
        });

        function observeElement(element) {
            if (element) {
                // Reset initial state before observing if the element might be re-added (like after filtering/searching)
                 element.classList.remove('visible');
                 element.style.transitionDelay = '0s';
                observer.observe(element);
            }
        }

        // --- Main Site Content Loading Function ---
        // Put all the loading and event listener setup for the main site here
        function loadSiteContent() {
            if (siteLoaded) return; // Prevent double loading
            siteLoaded = true; // Set flag

            // Set footer year
            const footerYear = document.getElementById('footerYear');
            if (footerYear) footerYear.textContent = new Date().getFullYear();

            // Load cart and user details from local storage
            loadCart();
            loadUserDetails();

            // Initial render of products and order summary based on loaded cart
            renderProducts('all', '');
            renderOrderSummary();


            // --- Event Listeners Setup (for main site) ---

            // Product Search Input
            const productSearchInput = document.getElementById('productSearch');
            if (productSearchInput) {
                 let searchTimeout;
                 productSearchInput.addEventListener('input', function() {
                     clearTimeout(searchTimeout);
                     const searchTerm = this.value;
                     searchTimeout = setTimeout(() => {
                         renderProducts(currentCategoryFilter, searchTerm);
                     }, 300); // Slightly longer debounce
                 });
            } else { console.error("Product search input not found."); }

            // Category Filter Select
            const categoryFilterSelect = document.getElementById('categoryFilter');
            if (categoryFilterSelect) {
                 categoryFilterSelect.addEventListener('change', function() {
                    const searchVal = document.getElementById('productSearch')?.value || '';
                    renderProducts(this.value, searchVal);
                 });
            } else { console.error("Category filter select not found."); }

             // Modal close on background click (for product modal)
             const productModal = document.getElementById('productModal');
             if (productModal) {
                 productModal.addEventListener('click', (event) => {
                     if (event.target === productModal) {
                         closeModal();
                     }
                 });
             }

             // --- Event Delegation for Product Card Controls and Modal Trigger ---
             const productsContainer = document.getElementById('productsContainer');
             if (productsContainer) {
                 productsContainer.addEventListener('click', (event) => {
                     const target = event.target;
                     // Find the closest product card element to get the product ID
                     const productCard = target.closest('.product-card');
                     const productId = productCard?.getAttribute('data-product-id');

                     if (!productId) return; // Not inside a product card or product ID missing

                     // Check if the click was on a specific button class
                     if (target.classList.contains('btn-add')) {
                         // Stop propagation if it's an add button click, so it doesn't also trigger the modal
                         event.stopPropagation();
                         addItemToOrder(productId);
                     } else if (target.classList.contains('btn-increase')) {
                          event.stopPropagation();
                         increaseQuantity(productId);
                     } else if (target.classList.contains('btn-decrease')) {
                          event.stopPropagation();
                         decreaseQuantity(productId);
                     }
                      // Modal click is handled by the click listener added directly to the card in createProductCard function
                 });
             } else { console.error("productsContainer not found for event delegation."); }

              // --- Coupon Input Listener ---
              const couponCodeInput = document.getElementById('couponCode');
              if (couponCodeInput) {
                  couponCodeInput.addEventListener('input', renderOrderSummary); // Update summary on input change
              } else { console.error("Coupon code input not found."); }


             // --- Order Form Submission Listener ---
             const orderForm = document.getElementById('orderForm');
             const placeOrderBtn = document.getElementById('placeOrderBtn'); // Get the button
             const orderFormContainer = document.getElementById('orderFormContainer'); // Get the container
             const orderSuccessMessageDiv = document.getElementById('orderSuccessMessage');
             const submissionStatusMessageP = document.getElementById('submissionStatusMessage');
             const upiPaymentInstructionsDiv = document.getElementById('upiPaymentInstructions');
             const orderPaymentSelect = document.getElementById('orderPayment'); // Get the payment select


             if (orderForm && placeOrderBtn && orderFormContainer && orderSuccessMessageDiv && submissionStatusMessageP && upiPaymentInstructionsDiv && orderPaymentSelect) {

                  // Add event listener to the payment select to show/hide UPI instructions dynamically
                 orderPaymentSelect.addEventListener('change', function() {
                      renderOrderSummary(); // Keep this to update any summary text if needed by payment method

                      if (this.value === 'UPI') {
                          upiPaymentInstructionsDiv.classList.remove('hidden');
                           // Optional: Scroll to the UPI instructions section
                           upiPaymentInstructionsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                      } else {
                          upiPaymentInstructionsDiv.classList.add('hidden');
                      }
                 });

                 // Trigger the change event listener once on load to show/hide UPI based on default selection
                 // This is important if UPI is the default or if state is loaded from local storage
                 orderPaymentSelect.dispatchEvent(new Event('change'));


                 orderForm.addEventListener('submit', function(event) {
                     event.preventDefault(); // Prevent the default form submission/page redirect

                     // Basic validation: Check if any items are in the order
                     if (Object.keys(orderItems).length === 0) {
                          alert("Your order list is empty. Please add items from the collection before placing an order.");
                          return; // Stop here if order is empty
                     }

                     // Save user details before submitting
                     saveUserDetails();

                     // Disable the submit button and change text
                     placeOrderBtn.disabled = true;
                     placeOrderBtn.textContent = 'Sending Order...';

                     // Ensure the hidden order summary is populated just before submitting
                     renderOrderSummary(); // This updates #hiddenOrderSummary

                     // Gather form data
                     const formData = new FormData(orderForm);

                     // Get selected payment method
                     const selectedPaymentMethod = orderPaymentSelect.value;
                     formData.append('Payment Method', selectedPaymentMethod); // Add payment method to form data

                     // Add FormSubmit AJAX parameter
                     formData.append('_ajax', 'true');

                     // Use fetch API to send the form data
                     fetch(orderForm.action, {
                         method: 'POST',
                         body: formData,
                         headers: {
                             'Accept': 'application/json' // FormSubmit requires this for AJAX response
                         }
                     })
                     .then(response => {
                         // FormSubmit returns a JSON response for AJAX
                         if (response.ok) { // Check if response status is 2xx
                             return response.json(); // Parse JSON response
                         } else {
                             // Handle HTTP errors (e.g., 400, 500)
                             return response.json().then(data => {
                                  throw new Error(data.message || `Form submission failed with status: ${response.status}`);
                             }).catch(() => {
                                  throw new Error(`Form submission failed with status: ${response.status}`);
                             });
                         }
                     })
                     .then(data => {
                         // Success response from FormSubmit
                         console.log('FormSubmit Success:', data);

                         // Clear cart and user details *after* successful submission
                         orderItems = {}; // Clear the order state
                         saveCart(); // Save empty cart to local storage
                         clearUserDetails(); // Clear user details (clears input fields and storage)

                         // Hide the form and show the success message
                         orderForm.classList.add('hidden'); // Hide the form itself
                         // Hide the UPI instructions as the order is now submitted
                         upiPaymentInstructionsDiv.classList.add('hidden');


                         orderSuccessMessageDiv.classList.remove('hidden');

                         // Set the status message based on payment method
                         if (selectedPaymentMethod === 'UPI') {
                             submissionStatusMessageP.textContent = "Your order details have been sent. Please ensure you have completed the UPI payment using the details provided above. We will manually verify your payment and contact you regarding order confirmation.";
                              orderSuccessMessageDiv.style.backgroundColor = 'var(--secondary-accent)'; // Pink background for UPI success
                              orderSuccessMessageDiv.style.borderColor = 'var(--primary-accent)'; // Teal border

                         } else { // COD
                              submissionStatusMessageP.textContent = "You selected Cash on Delivery. We will contact you to confirm your order.";
                              orderSuccessMessageDiv.style.backgroundColor = 'var(--success-color)'; // Green color for COD success
                               orderSuccessMessageDiv.style.borderColor = 'darkgreen';

                         }

                          // Scroll to the success message/instructions area
                          orderSuccessMessageDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });


                     })
                     .catch(error => {
                         // Handle any errors during the fetch or FormSubmit processing
                         console.error('Form submission error:', error);

                         // Show an error message to the user
                         alert("Sorry, there was an error submitting your order: " + error.message + "\nPlease try again.");

                         // Re-enable the button and reset text
                         placeOrderBtn.disabled = false;
                         placeOrderBtn.textContent = 'Place Order';
                          // Re-load user details in case they were cleared on a perceived 'success' that failed late
                         loadUserDetails();
                         // Re-render order summary to reflect current cart state (which wasn't cleared)
                         renderOrderSummary();
                          // Keep UPI instructions visible if UPI was selected and submission failed
                           if (orderPaymentSelect.value === 'UPI') {
                                upiPaymentInstructionsDiv.classList.remove('hidden');
                           }


                     });
                 });


             } else { console.error("Order form, button, or other required elements not found for submission handling."); }


              // --- Forget My Details Button Listener ---
              const forgetButton = document.getElementById('forgetMyDetailsBtn');
              if(forgetButton) {
                  forgetButton.addEventListener('click', clearUserDetails);
              }


             // Observe elements with 'reveal' class initially present in HTML
              // These are non-product card elements like titles, headers, etc.
              document.querySelectorAll('.reveal').forEach(el => {
                  // Don't observe product cards here, they are handled in renderProducts
                  // Also don't observe the full terms section if it's initially hidden
                  if (!el.classList.contains('product-card') && !el.closest('#termsAndConditionsFull')) {
                     observeElement(el);
                  }
              });

              // Ensure body overflow is correct after loading content (should not be hidden if terms accepted)
               updateBodyOverflow();

        } // End of loadSiteContent function


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
          try {
              // Get references to T&C elements
              const termsModal = document.getElementById('termsModal');
              const acceptTermsBtn = document.getElementById('acceptTermsBtn');
              const viewTermsLink = document.getElementById('viewTermsLink');
              const termsAndConditionsFull = document.getElementById('termsAndConditionsFull');
              const backToSiteBtn = document.getElementById('backToSiteBtn');

              if (!termsModal || !acceptTermsBtn || !viewTermsLink || !termsAndConditionsFull || !backToSiteBtn) {
                  console.error("Missing one or more Terms & Conditions elements. Site may not function as expected.");
                  // Proceed to load site content anyway, but the T&C feature might be broken.
                  loadSiteContent();
                  return; // Stop further T&C setup
              }

              // Check if terms have been accepted on first visit
              const termsAccepted = localStorage.getItem(TERMS_ACCEPTED_STORAGE_KEY);

              if (termsAccepted !== 'true') {
                  // Show the terms modal only on the first visit
                  showTermsModal();

                  // Set up listeners for the terms modal buttons
                  acceptTermsBtn.addEventListener('click', () => {
                       localStorage.setItem(TERMS_ACCEPTED_STORAGE_KEY, 'true');
                       hideTermsModal();
                       // Now that terms are accepted, load the main site content
                       loadSiteContent();
                   });

                   viewTermsLink.addEventListener('click', (event) => {
                       event.preventDefault(); // Stop the link from doing anything else
                       hideTermsModal();
                       showFullTerms();
                   });

                  // The exitWebsite function is called via onclick attribute in HTML on the close button

              } else {
                  // Terms were already accepted, load the main site content directly
                   loadSiteContent();
              }

              // Listener for the "Back to Site" button on the full T&C page
              // This listener will ALWAYS show the initial terms modal again, regardless
              // of whether terms were previously accepted via the modal.
              backToSiteBtn.addEventListener('click', () => {
                  hideFullTerms();
                  showTermsModal(); // Show the initial modal again

                  // Optional: Scroll to top of page when returning to the modal
                  window.scrollTo(0, 0);
              });


          } catch (error) {
               console.error("Critical error during DOMContentLoaded initialization:", error);
               // Use a more robust error display
               const errorDiv = document.createElement('div');
               errorDiv.style.cssText = "padding: 40px; text-align: center; font-family: sans-serif; color: white; background-color: #333; margin: 20px; border-radius: 8px;";
               errorDiv.innerHTML = `<h1>Oops!</h1><p>Something went wrong while loading the page content.</p><p>Please <a href="javascript:location.reload();" style="color: var(--primary-accent); text-decoration: underline;">refresh</a> and try again.</p><p style="font-size: 0.8em; color: var(--text-secondary);">Error details: ${escapeHtml(error.message)}</p>`;
               document.body.innerHTML = ''; // Clear existing body content
               document.body.appendChild(errorDiv);
          }
        });
    </script>

</body>
</html>
